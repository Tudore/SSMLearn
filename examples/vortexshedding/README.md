This is a preview of the livescript `vortexshedding.mlx`.

# Vortex Shedding behind a Cylinder

POD (Principal Orthogonal Decomposition) trajectories (projections of velocity and pressure data to a linear subspace) of a flow past a cylinder (2D simulations from CFD) at Reynolds number equal to 70. Initial conditions are close to the origin, which is unstable, from which these trajectories converge to a stable limit cycle (representing the vortex shedding regime.

![image_0.png
](README_images/image_0.png
)

```matlab:Code
clearvars
close all
clc

% Load and display data
load data
idx = [1 3 5]; nTraj = size(PODTraj,1);
customFigure('subPlot',[length(idx) 1]); colors = winter(nTraj);
for ii = 1:nTraj
    for jj = 1:length(idx)
        subplot(length(idx),1,jj); hold on; grid on; box on;
        plot(PODTraj{ii,1},PODTraj{ii,2}(idx(jj),:),'Linewidth',1,'Color',colors(ii,:))
        xlabel('$t \, [$s$]$','Interpreter','latex')
        ylabel(['$a_{' num2str(idx(jj)) '}$'],'Interpreter','latex')
        xlim([0 200])
    end
end
```

![figure_0.png
](README_images/figure_0.png
)

# Datadriven SSM

The first two POD coordinates are used to parametrize the unstable manifold connecting the unstable steady flow to the stable limit cycle. Hence we impose a user-defined chart in this example, and we look for a polynomial parametrization for the unstable manifold over these POD coordinates.

```matlab:Code
% Data embedding: there is no need of delay embedding in this case, but the
% function checks the data to be in suitable format
SSM_dim = 2; 
[yData,opts_embd] = coordinatesEmbedding(PODTraj,SSM_dim);
```

```text:Output
The embedding coordinates consist of the measured states.
```

```matlab:Code
% Split in training and testing dataset
indTrain = 1:8;
indTest = 9;

% Polynomial degree of the parametrization
ParamDeg = 18; 
V = [eye(SSM_dim); zeros(size(yData{1,2},1)-SSM_dim,SSM_dim)];
IMInfo = IMGeometry(yData(indTrain,:),SSM_dim,ParamDeg,'chart',@(x) V'*x);

% Compute relative root-mean-squared error on test set, normalized w.r.t.
% the maximum norm point and expressed in percentage
errorTestSet = computeParametrizationErrors(IMInfo, yData(indTest,:))*100
```

```text:Output
errorTestSet = 
      0.21774

```

# Plot and validation

Now that we have computed the eigenspace of the manifold, we pass to the reduced coordinates $y$ by projecting all trajectories onto the 2-dim. leading space POD. 

```matlab:Code
etaData = projectTrajectories(IMInfo, yData);
indPlot = 1:3:length(indTrain);
plotSSMWithTrajectories(IMInfo, [1 2 5], yData(indTrain(indPlot),:),'Margin',0,'Colors',winter(length(indPlot)))
view(-100,20); zlabel('$a_3$','Interpreter','latex')
```

![figure_1.png
](README_images/figure_1.png
)

# Reduced Dynamics

To accurately reconstruct the dynamics, we need a high-order normal form of the form $\dot{\rho} =c\left(\rho \right)\rho$, $\dot{\theta} =\omega \left(\rho \right)$, which is sought from data.

```matlab:Code
ROMOrder = 11;
RDInfo = IMDynamicsFlow(etaData(indTrain,:), ...
    'R_PolyOrd', ROMOrder, 'style', 'normalform','MaxIter',2e3);
```

```text:Output
Estimation of the reduced dynamics...  Done. 
Estimation of the reduced dynamics in normal form...
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
     0           1      0.000140317                        0.0033
     1           3      4.13791e-05             10        0.00171  
     2           5      1.68909e-05       0.344258        0.00155  
     3           6      8.32405e-06              1       0.000949  
     4           7      1.35293e-06              1       0.000248  
     5           8      9.22708e-07              1       0.000101  
     6           9      8.05183e-07              1       6.76e-05  
     7          11      7.73253e-07       0.321918        4.3e-05  
     8          12      7.36067e-07              1       1.83e-05  
     9          13      7.23117e-07              1       3.01e-06  
    10          15      7.20034e-07             10       1.24e-05  
    11          16      7.17192e-07              1       8.69e-06  
    12          17      7.12627e-07              1       7.84e-06  
    13          18      7.09503e-07              1       8.36e-06  
    14          19      7.00485e-07              1       1.28e-05  
    15          20      6.89154e-07              1       1.39e-05  
    16          21       6.8114e-07              1       1.03e-05  
    17          22      6.75434e-07              1       9.31e-06  
    18          23      6.67439e-07              1       1.05e-05  
    19          24      6.53933e-07              1       1.74e-05  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
    20          25      6.36808e-07              1       1.84e-05  
    21          26      6.23348e-07              1          1e-05  
    22          27      6.15743e-07              1       7.22e-06  
    23          28      6.09494e-07              1       7.96e-06  
    24          29      6.00411e-07              1       1.41e-05  
    25          30      5.88583e-07              1       1.49e-05  
    26          31      5.77373e-07              1       8.45e-06  
    27          32      5.69063e-07              1       9.95e-06  
    28          33      5.62343e-07              1       8.25e-06  
    29          34      5.56426e-07              1       9.52e-06  
    30          35      5.52662e-07              1       5.71e-06  
    31          36      5.51006e-07              1       3.37e-06  
    32          37      5.49879e-07              1       3.41e-06  
    33          38      5.47894e-07              1       7.09e-06  
    34          39      5.43963e-07              1       1.08e-05  
    35          40      5.36807e-07              1       1.28e-05  
    36          41      5.25647e-07              1       1.43e-05  
    37          42      5.10022e-07              1       1.56e-05  
    38          43      4.88949e-07              1       1.59e-05  
    39          44      4.61969e-07              1        1.9e-05  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
    40          45      4.34792e-07              1       2.11e-05  
    41          46      4.17367e-07              1       1.21e-05  
    42          47      4.09288e-07              1       1.08e-05  
    43          48       4.0299e-07              1       1.03e-05  
    44          49      3.91117e-07              1       1.73e-05  
    45          50      3.66717e-07              1       2.91e-05  
    46          51      3.24615e-07              1       3.65e-05  
    47          52       2.7821e-07              1       2.94e-05  
    48          53      2.52174e-07              1       1.09e-05  
    49          54      2.44028e-07              1       6.15e-06  
    50          55       2.3975e-07              1       6.79e-06  
    51          56      2.32815e-07              1       1.08e-05  
    52          57      2.22772e-07              1       1.13e-05  
    53          58      2.11235e-07              1       1.52e-05  
    54          59      2.00827e-07              1        1.5e-05  
    55          60       1.9132e-07              1       9.86e-06  
    56          61      1.81898e-07              1       9.44e-06  
    57          62      1.73435e-07              1       8.92e-06  
    58          63      1.66812e-07              1       1.06e-05  
    59          64      1.60889e-07              1       1.06e-05  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
    60          65       1.5449e-07              1       8.84e-06  
    61          66      1.49171e-07              1       7.78e-06  
    62          67      1.46939e-07              1       3.34e-06  
    63          68      1.46499e-07              1       1.24e-06  
    64          69      1.46359e-07              1       1.47e-06  
    65          70      1.46068e-07              1       1.75e-06  
    66          71      1.45393e-07              1        3.1e-06  
    67          72      1.43863e-07              1       4.89e-06  
    68          73       1.4103e-07              1       6.24e-06  
    69          74      1.37334e-07              1       5.47e-06  
    70          75      1.34585e-07              1       5.54e-06  
    71          76      1.33424e-07              1       3.96e-06  
    72          77      1.32926e-07              1       2.14e-06  
    73          78      1.32521e-07              1       1.76e-06  
    74          79      1.32157e-07              1       1.67e-06  
    75          80      1.31818e-07              1       2.78e-06  
    76          81      1.31317e-07              1       3.53e-06  
    77          82      1.30229e-07              1       4.22e-06  
    78          83      1.27709e-07              1       5.52e-06  
    79          84       1.2233e-07              1       8.28e-06  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
    80          85      1.13289e-07              1       9.58e-06  
    81          86      1.03746e-07              1       6.99e-06  
    82          87       9.8779e-08              1       5.26e-06  
    83          88      9.75124e-08              1       2.86e-06  
    84          89       9.7169e-08              1       1.46e-06  
    85          90      9.69587e-08              1       8.47e-07  
    86          91       9.6856e-08              1       8.52e-07  
    87          92      9.68114e-08              1       8.58e-07  
    88          93      9.67694e-08              1       8.59e-07  
    89          94      9.67027e-08              1       8.48e-07  
    90          95      9.66086e-08              1       9.12e-07  
    91          96       9.6479e-08              1       1.66e-06  
    92          97      9.62876e-08              1       2.19e-06  
    93          98      9.59806e-08              1       2.33e-06  
    94          99      9.55534e-08              1       1.77e-06  
    95         100      9.51589e-08              1        1.4e-06  
    96         101      9.49531e-08              1       1.37e-06  
    97         102       9.4865e-08              1       1.19e-06  
    98         103      9.47863e-08              1       9.19e-07  
    99         104      9.46775e-08              1       6.07e-07  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   100         105      9.45836e-08              1       4.63e-07  
   101         106      9.45419e-08              1       3.29e-07  
   102         107      9.45295e-08              1       2.92e-07  
   103         108      9.45199e-08              1       2.72e-07  
   104         109      9.45027e-08              1       2.16e-07  
   105         110      9.44797e-08              1       5.14e-07  
   106         111      9.44568e-08              1       7.13e-07  
   107         112        9.444e-08              1       6.55e-07  
   108         113      9.44274e-08              1       4.04e-07  
   109         114      9.44172e-08              1       1.93e-07  
   110         115      9.44097e-08              1       2.05e-07  
   111         116      9.44034e-08              1       3.43e-07  
   112         117      9.43938e-08              1       4.32e-07  
   113         118      9.43724e-08              1       5.07e-07  
   114         119      9.43211e-08              1       5.72e-07  
   115         120      9.42058e-08              1       7.85e-07  
   116         121      9.39942e-08              1       9.99e-07  
   117         122        9.374e-08              1       8.59e-07  
   118         123      9.35894e-08              1       5.64e-07  
   119         124      9.35501e-08              1       5.45e-07  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   120         125      9.35391e-08              1        5.1e-07  
   121         126      9.35232e-08              1       4.49e-07  
   122         127      9.34908e-08              1       3.25e-07  
   123         128       9.3444e-08              1       2.97e-07  
   124         129      9.34032e-08              1       3.92e-07  
   125         130      9.33834e-08              1       4.54e-07  
   126         131      9.33733e-08              1       4.19e-07  
   127         132      9.33601e-08              1       3.25e-07  
   128         133      9.33383e-08              1       3.12e-07  
   129         134      9.33126e-08              1       3.89e-07  
   130         135      9.32935e-08              1       3.84e-07  
   131         136      9.32817e-08              1        3.5e-07  
   132         137      9.32689e-08              1       3.96e-07  
   133         138      9.32456e-08              1       4.36e-07  
   134         139      9.32027e-08              1       9.14e-07  
   135         140      9.31286e-08              1       1.64e-06  
   136         141      9.30101e-08              1       2.31e-06  
   137         142      9.28311e-08              1       2.64e-06  
   138         143      9.25966e-08              1       2.26e-06  
   139         144      9.23805e-08              1       1.15e-06  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   140         145      9.22742e-08              1       2.29e-07  
   141         146      9.22509e-08              1        1.3e-07  
   142         147      9.22479e-08              1       1.26e-07  
   143         148      9.22464e-08              1       1.24e-07  
   144         149      9.22428e-08              1       1.21e-07  
   145         150      9.22349e-08              1       2.92e-07  
   146         151      9.22166e-08              1       5.27e-07  
   147         152      9.21833e-08              1       7.18e-07  
   148         153      9.21431e-08              1       6.51e-07  
   149         154      9.21188e-08              1       3.03e-07  
   150         155       9.2112e-08              1       2.08e-07  
   151         156      9.21095e-08              1       1.97e-07  
   152         157      9.21048e-08              1          2e-07  
   153         158      9.20932e-08              1       3.86e-07  
   154         159      9.20648e-08              1       6.52e-07  
   155         160      9.20029e-08              1       9.63e-07  
   156         161       9.1898e-08              1       1.12e-06  
   157         162      9.17907e-08              1       8.36e-07  
   158         163      9.17421e-08              1       2.96e-07  
   159         164       9.1734e-08              1       8.29e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   160         165      9.17331e-08              1       8.22e-08  
   161         166      9.17322e-08              1       8.05e-08  
   162         167      9.17293e-08              1       9.06e-08  
   163         168      9.17228e-08              1       1.51e-07  
   164         169      9.17078e-08              1       2.26e-07  
   165         170      9.16816e-08              1       2.71e-07  
   166         171      9.16523e-08              1       2.16e-07  
   167         172      9.16367e-08              1       1.59e-07  
   168         173      9.16329e-08              1       1.57e-07  
   169         174      9.16316e-08              1       1.49e-07  
   170         175      9.16287e-08              1       1.36e-07  
   171         176      9.16215e-08              1       1.15e-07  
   172         177      9.16031e-08              1       1.91e-07  
   173         178      9.15577e-08              1       3.09e-07  
   174         179      9.14561e-08              1       4.53e-07  
   175         180      9.12742e-08              1       5.43e-07  
   176         181      9.10681e-08              1       4.37e-07  
   177         182        9.096e-08              1       1.77e-07  
   178         183      9.09398e-08              1       6.08e-08  
   179         184      9.09385e-08              1       5.84e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   180         185      9.09383e-08              1       5.79e-08  
   181         186      9.09376e-08              1        5.7e-08  
   182         187      9.09361e-08              1       5.56e-08  
   183         188      9.09319e-08              1       5.33e-08  
   184         189      9.09212e-08              1       4.97e-08  
   185         190      9.08934e-08              1       4.88e-08  
   186         191      9.08233e-08              1       7.97e-08  
   187         192      9.06564e-08              1       1.22e-07  
   188         193      9.03117e-08              1        1.7e-07  
   189         194      8.97913e-08              1       3.14e-07  
   190         195      8.93568e-08              1       4.37e-07  
   191         196      8.92057e-08              1       4.61e-07  
   192         197      8.91838e-08              1       4.43e-07  
   193         198      8.91772e-08              1       4.32e-07  
   194         199      8.91594e-08              1        4.1e-07  
   195         200      8.91174e-08              1       3.74e-07  
   196         201      8.90098e-08              1       3.09e-07  
   197         202       8.8767e-08              1       1.98e-07  
   198         203      8.83094e-08              1        9.5e-08  
   199         204      8.77446e-08              1       1.23e-07  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   200         205      8.74049e-08              1       1.49e-07  
   201         206      8.73294e-08              1       1.65e-07  
   202         207      8.73233e-08              1       1.66e-07  
   203         208      8.73221e-08              1       1.65e-07  
   204         209      8.73183e-08              1       1.64e-07  
   205         210      8.73096e-08              1       1.62e-07  
   206         211      8.72863e-08              1       1.58e-07  
   207         212      8.72308e-08              1       1.52e-07  
   208         213      8.71106e-08              1       1.43e-07  
   209         214      8.69128e-08              1       2.91e-07  
   210         215      8.67186e-08              1        4.4e-07  
   211         216      8.66338e-08              1       4.64e-07  
   212         217      8.66176e-08              1        4.3e-07  
   213         218      8.66124e-08              1       4.09e-07  
   214         219      8.66001e-08              1       3.75e-07  
   215         220      8.65699e-08              1       3.21e-07  
   216         221      8.64908e-08              1       2.32e-07  
   217         222      8.62947e-08              1       2.02e-07  
   218         223      8.58385e-08              1        2.3e-07  
   219         224      8.49529e-08              1       3.63e-07  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   220         225       8.3777e-08              1        4.7e-07  
   221         226      8.29881e-08              1       3.02e-07  
   222         227      8.27878e-08              1       1.15e-07  
   223         228      8.27713e-08              1       1.13e-07  
   224         229      8.27704e-08              1       1.13e-07  
   225         230      8.27693e-08              1       1.12e-07  
   226         231      8.27658e-08              1       1.12e-07  
   227         232      8.27574e-08              1       1.11e-07  
   228         233      8.27348e-08              1       1.09e-07  
   229         234      8.26788e-08              1       1.06e-07  
   230         235      8.25451e-08              1        1.1e-07  
   231         236      8.22712e-08              1       1.53e-07  
   232         237      8.18637e-08              1       1.59e-07  
   233         238      8.15334e-08              1       1.75e-07  
   234         239      8.14249e-08              1       1.84e-07  
   235         240      8.14121e-08              1       1.76e-07  
   236         241      8.14103e-08              1       1.73e-07  
   237         242      8.14069e-08              1       1.67e-07  
   238         243      8.13979e-08              1       1.57e-07  
   239         244       8.1375e-08              1       1.36e-07  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   240         245      8.13176e-08              1       1.06e-07  
   241         246      8.11845e-08              1       1.07e-07  
   242         247       8.0925e-08              1       1.37e-07  
   243         248      8.05784e-08              1       3.17e-07  
   244         249      8.03415e-08              1       4.12e-07  
   245         250      8.02774e-08              1       3.94e-07  
   246         251      8.02689e-08              1       3.66e-07  
   247         252      8.02644e-08              1       3.51e-07  
   248         253      8.02495e-08              1        3.2e-07  
   249         254      8.02148e-08              1       2.74e-07  
   250         255      8.01214e-08              1       2.33e-07  
   251         256      7.98891e-08              1       2.44e-07  
   252         257      7.93314e-08              1        2.5e-07  
   253         258      7.81754e-08              1       3.52e-07  
   254         259      7.64128e-08              1       5.01e-07  
   255         260      7.49255e-08              1       3.85e-07  
   256         261      7.44137e-08              1       1.62e-07  
   257         262      7.43554e-08              1       1.58e-07  
   258         263      7.43527e-08              1       1.56e-07  
   259         264      7.43516e-08              1       1.55e-07  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   260         265      7.43464e-08              1       1.53e-07  
   261         266      7.43354e-08              1        1.5e-07  
   262         267      7.43048e-08              1       1.43e-07  
   263         268      7.42307e-08              1       1.29e-07  
   264         269      7.40568e-08              1       1.02e-07  
   265         270       7.3721e-08              1       1.18e-07  
   266         271      7.32758e-08              1        1.3e-07  
   267         272      7.29785e-08              1       1.78e-07  
   268         273      7.29028e-08              1       1.77e-07  
   269         274      7.28959e-08              1       1.68e-07  
   270         275      7.28948e-08              1       1.65e-07  
   271         276       7.2892e-08              1       1.59e-07  
   272         277      7.28851e-08              1        1.5e-07  
   273         278      7.28669e-08              1       1.33e-07  
   274         279      7.28224e-08              1       1.03e-07  
   275         280      7.27213e-08              1       6.45e-08  
   276         281       7.2536e-08              1       6.48e-08  
   277         282      7.23156e-08              1       9.43e-08  
   278         283      7.21911e-08              1       1.02e-07  
   279         284      7.21653e-08              1       8.56e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   280         285      7.21633e-08              1       8.71e-08  
   281         286      7.21627e-08              1       8.68e-08  
   282         287      7.21606e-08              1       8.58e-08  
   283         288      7.21558e-08              1       8.44e-08  
   284         289      7.21425e-08              1       8.18e-08  
   285         290      7.21087e-08              1       7.74e-08  
   286         291       7.2021e-08              1       6.96e-08  
   287         292      7.18024e-08              1       1.17e-07  
   288         293      7.12933e-08              1       2.11e-07  
   289         294      7.02969e-08              1       3.01e-07  
   290         295      6.89538e-08              1       3.02e-07  
   291         296        6.803e-08              1       1.71e-07  
   292         297      6.77874e-08              1       1.75e-07  
   293         298      6.77662e-08              1        1.7e-07  
   294         299      6.77645e-08              1       1.68e-07  
   295         300      6.77618e-08              1       1.65e-07  
   296         301       6.7754e-08              1       1.62e-07  
   297         302      6.77344e-08              1       1.56e-07  
   298         303       6.7683e-08              1       1.46e-07  
   299         304      6.75526e-08              1       1.31e-07  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   300         305      6.72329e-08              1        1.1e-07  
   301         306      6.65288e-08              1       8.46e-08  
   302         307      6.53091e-08              1       1.78e-07  
   303         308      6.40126e-08              1       2.96e-07  
   304         309      6.33922e-08              1       3.26e-07  
   305         310      6.32862e-08              1       3.01e-07  
   306         311      6.32774e-08              1       2.88e-07  
   307         312      6.32726e-08              1       2.83e-07  
   308         313      6.32542e-08              1       2.69e-07  
   309         314      6.32125e-08              1       2.49e-07  
   310         315      6.30978e-08              1       2.15e-07  
   311         316      6.28092e-08              1       1.82e-07  
   312         317      6.20827e-08              1       1.83e-07  
   313         318      6.04037e-08              1       1.73e-07  
   314         319      5.71402e-08              1       2.16e-07  
   315         320      5.28207e-08              1       2.92e-07  
   316         321      4.99326e-08              1       1.97e-07  
   317         322      4.92045e-08              1       1.16e-07  
   318         323      4.91464e-08              1       1.16e-07  
   319         324      4.91444e-08              1       1.15e-07  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   320         325      4.91434e-08              1       1.15e-07  
   321         326      4.91389e-08              1       1.15e-07  
   322         327      4.91292e-08              1       1.14e-07  
   323         328      4.91017e-08              1       1.13e-07  
   324         329       4.9033e-08              1        1.1e-07  
   325         330      4.88584e-08              1       1.03e-07  
   326         331      4.84486e-08              1       8.86e-08  
   327         332      4.76197e-08              1        6.1e-08  
   328         333      4.64318e-08              1       7.55e-08  
   329         334      4.55262e-08              1       1.13e-07  
   330         335      4.52549e-08              1       1.16e-07  
   331         336      4.52283e-08              1        1.1e-07  
   332         337      4.52271e-08              1       1.08e-07  
   333         338      4.52264e-08              1       1.07e-07  
   334         339      4.52233e-08              1       1.04e-07  
   335         340      4.52165e-08              1       1.01e-07  
   336         341      4.51977e-08              1        9.4e-08  
   337         342      4.51506e-08              1       8.16e-08  
   338         343      4.50329e-08              1       5.78e-08  
   339         344      4.47663e-08              1       5.41e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   340         345      4.42712e-08              1       5.31e-08  
   341         346      4.36725e-08              1       1.18e-07  
   342         347      4.33253e-08              1       1.34e-07  
   343         348       4.3252e-08              1       1.16e-07  
   344         349      4.32469e-08              1       1.06e-07  
   345         350      4.32464e-08              1       1.04e-07  
   346         351      4.32454e-08              1       1.02e-07  
   347         352      4.32428e-08              1       9.75e-08  
   348         353      4.32359e-08              1       9.07e-08  
   349         354      4.32181e-08              1       7.91e-08  
   350         355      4.31725e-08              1       5.93e-08  
   351         356      4.30595e-08              1       5.38e-08  
   352         357      4.28025e-08              1       5.28e-08  
   353         358      4.23253e-08              1       9.61e-08  
   354         359      4.17464e-08              1       1.42e-07  
   355         360      4.14093e-08              1       1.25e-07  
   356         361      4.13377e-08              1          1e-07  
   357         362      4.13327e-08              1        9.9e-08  
   358         363      4.13322e-08              1       9.81e-08  
   359         364      4.13309e-08              1       9.67e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   360         365      4.13277e-08              1       9.44e-08  
   361         366      4.13193e-08              1       9.06e-08  
   362         367      4.12977e-08              1       8.41e-08  
   363         368       4.1242e-08              1        7.3e-08  
   364         369      4.11036e-08              1       5.41e-08  
   365         370      4.07855e-08              1       4.37e-08  
   366         371      4.01815e-08              1       8.04e-08  
   367         372      3.94154e-08              1       9.38e-08  
   368         373      3.89375e-08              1        5.6e-08  
   369         374      3.88272e-08              1       4.26e-08  
   370         375      3.88192e-08              1       4.26e-08  
   371         376      3.88189e-08              1       4.23e-08  
   372         377      3.88187e-08              1       4.22e-08  
   373         378       3.8818e-08              1       4.18e-08  
   374         379      3.88163e-08              1       4.13e-08  
   375         380      3.88116e-08              1       4.05e-08  
   376         381      3.87999e-08              1       3.91e-08  
   377         382      3.87706e-08              1       3.69e-08  
   378         383      3.87037e-08              1       3.38e-08  
   379         384      3.85776e-08              1       5.91e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   380         385      3.84202e-08              1        1.2e-07  
   381         386      3.83242e-08              1       1.53e-07  
   382         387      3.83023e-08              1        1.5e-07  
   383         388      3.83003e-08              1       1.43e-07  
   384         389      3.82997e-08              1       1.41e-07  
   385         390      3.82978e-08              1       1.36e-07  
   386         391      3.82933e-08              1       1.28e-07  
   387         392      3.82811e-08              1       1.14e-07  
   388         393      3.82499e-08              1       9.22e-08  
   389         394      3.81701e-08              1       5.64e-08  
   390         395      3.79763e-08              1       3.95e-08  
   391         396      3.75535e-08              1       7.51e-08  
   392         397      3.68405e-08              1       1.42e-07  
   393         398      3.61185e-08              1       1.35e-07  
   394         399      3.57982e-08              1       5.98e-08  
   395         400      3.57496e-08              1       2.49e-08  
   396         401      3.57473e-08              1       2.44e-08  
   397         402      3.57473e-08              1       2.44e-08  
   398         403      3.57472e-08              1       2.43e-08  
   399         404      3.57469e-08              1       2.41e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   400         405      3.57463e-08              1       2.38e-08  
   401         406      3.57447e-08              1       2.32e-08  
   402         407      3.57404e-08              1       2.19e-08  
   403         408      3.57294e-08              1       1.92e-08  
   404         409      3.57022e-08              1       1.75e-08  
   405         410      3.56394e-08              1       1.64e-08  
   406         411      3.55196e-08              1       2.72e-08  
   407         412      3.53662e-08              1       6.06e-08  
   408         413      3.52691e-08              1       7.96e-08  
   409         414      3.52462e-08              1       7.82e-08  
   410         415      3.52444e-08              1       7.44e-08  
   411         416      3.52442e-08              1       7.35e-08  
   412         417      3.52439e-08              1       7.23e-08  
   413         418      3.52431e-08              1       7.04e-08  
   414         419      3.52411e-08              1       6.73e-08  
   415         420      3.52357e-08              1       6.23e-08  
   416         421      3.52218e-08              1        5.4e-08  
   417         422      3.51855e-08              1       4.04e-08  
   418         423      3.50931e-08              1       2.21e-08  
   419         424      3.48663e-08              1       2.13e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   420         425      3.43632e-08              1       6.26e-08  
   421         426      3.34795e-08              1       1.06e-07  
   422         427      3.25159e-08              1       1.04e-07  
   423         428       3.2039e-08              1       5.48e-08  
   424         429      3.19564e-08              1       4.45e-08  
   425         430      3.19521e-08              1       4.41e-08  
   426         431      3.19519e-08              1       4.39e-08  
   427         432      3.19518e-08              1       4.38e-08  
   428         433      3.19513e-08              1       4.34e-08  
   429         434      3.19501e-08              1        4.3e-08  
   430         435      3.19469e-08              1        4.2e-08  
   431         436      3.19388e-08              1       4.03e-08  
   432         437      3.19189e-08              1        3.7e-08  
   433         438      3.18751e-08              1       3.12e-08  
   434         439      3.17992e-08              1       2.26e-08  
   435         440      3.17185e-08              1       4.13e-08  
   436         441      3.16799e-08              1       5.07e-08  
   437         442      3.16735e-08              1       4.73e-08  
   438         443      3.16732e-08              1       4.51e-08  
   439         444      3.16731e-08              1       4.46e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   440         445      3.16729e-08              1       4.35e-08  
   441         446      3.16726e-08              1        4.2e-08  
   442         447      3.16715e-08              1       3.91e-08  
   443         448       3.1669e-08              1       3.43e-08  
   444         449      3.16625e-08              1       2.59e-08  
   445         450      3.16479e-08              1       2.01e-08  
   446         451      3.16208e-08              1       1.63e-08  
   447         452       3.1588e-08              1       2.04e-08  
   448         453      3.15691e-08              1       1.85e-08  
   449         454      3.15651e-08              1       1.38e-08  
   450         455      3.15648e-08              1       1.39e-08  
   451         456      3.15648e-08              1       1.39e-08  
   452         457      3.15648e-08              1       1.39e-08  
   453         458      3.15648e-08              1       1.39e-08  
   454         459      3.15646e-08              1       1.38e-08  
   455         460      3.15643e-08              1       1.38e-08  
   456         461      3.15633e-08              1       1.38e-08  
   457         462      3.15608e-08              1       1.38e-08  
   458         463      3.15545e-08              1       1.37e-08  
   459         464      3.15388e-08              1       1.77e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   460         465      3.15028e-08              1       2.96e-08  
   461         466      3.14349e-08              1       3.98e-08  
   462         467      3.13502e-08              1       3.74e-08  
   463         468      3.12987e-08              1       3.94e-08  
   464         469      3.12871e-08              1        3.9e-08  
   465         470      3.12863e-08              1       3.89e-08  
   466         471      3.12862e-08              1       3.87e-08  
   467         472      3.12861e-08              1       3.83e-08  
   468         473      3.12858e-08              1       3.78e-08  
   469         474       3.1285e-08              1       3.69e-08  
   470         475      3.12828e-08              1       3.54e-08  
   471         476      3.12773e-08              1       3.29e-08  
   472         477       3.1263e-08              1       2.87e-08  
   473         478      3.12267e-08              1       2.18e-08  
   474         479      3.11387e-08              1       1.14e-08  
   475         480      3.09494e-08              1       1.93e-08  
   476         481      3.06386e-08              1        3.3e-08  
   477         482       3.0339e-08              1        2.9e-08  
   478         483      3.02152e-08              1       1.24e-08  
   479         484      3.01979e-08              1       1.05e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   480         485      3.01972e-08              1          1e-08  
   481         486      3.01972e-08              1          1e-08  
   482         487      3.01972e-08              1          1e-08  
   483         488      3.01972e-08              1       9.96e-09  
   484         489      3.01971e-08              1       9.89e-09  
   485         490       3.0197e-08              1       9.71e-09  
   486         491      3.01967e-08              1       9.28e-09  
   487         492      3.01958e-08              1       8.23e-09  
   488         493       3.0194e-08              1       5.97e-09  
   489         494       3.0191e-08              1        2.5e-09  
   490         495      3.01879e-08              1       2.13e-09  
   491         496      3.01865e-08              1       3.63e-09  
   492         497      3.01863e-08              1       3.18e-09  
   493         498      3.01863e-08              1       2.88e-09  
   494         499      3.01863e-08              1       2.83e-09  
   495         500      3.01863e-08              1       2.74e-09  
   496         501      3.01863e-08              1       2.61e-09  
   497         502      3.01863e-08              1        2.4e-09  
   498         503      3.01863e-08              1       2.05e-09  
   499         504      3.01862e-08              1       1.99e-09  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   500         505      3.01859e-08              1       1.97e-09  
   501         506      3.01853e-08              1       2.13e-09  
   502         507      3.01838e-08              1       3.26e-09  
   503         508      3.01798e-08              1       6.95e-09  
   504         509      3.01702e-08              1       1.22e-08  
   505         510      3.01502e-08              1       1.82e-08  
   506         511      3.01192e-08              1       2.07e-08  
   507         512      3.00921e-08              1       1.49e-08  
   508         513      3.00824e-08              1       1.56e-08  
   509         514      3.00813e-08              1       1.57e-08  
   510         515      3.00812e-08              1       1.54e-08  
   511         516      3.00812e-08              1       1.54e-08  
   512         517      3.00811e-08              1       1.52e-08  
   513         518       3.0081e-08              1       1.49e-08  
   514         519      3.00808e-08              1       1.44e-08  
   515         520        3.008e-08              1       1.35e-08  
   516         521      3.00781e-08              1       1.18e-08  
   517         522      3.00736e-08              1       8.61e-09  
   518         523       3.0064e-08              1       4.74e-09  
   519         524      3.00485e-08              1       4.23e-09  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   520         525      3.00343e-08              1       9.15e-09  
   521         526      3.00288e-08              1       8.59e-09  
   522         527      3.00281e-08              1        7.4e-09  
   523         528      3.00281e-08              1        7.4e-09  
   524         529      3.00281e-08              1       7.39e-09  
   525         530      3.00281e-08              1       7.37e-09  
   526         531      3.00281e-08              1       7.34e-09  
   527         532       3.0028e-08              1       7.28e-09  
   528         533      3.00278e-08              1       7.19e-09  
   529         534      3.00274e-08              1       7.05e-09  
   530         535      3.00264e-08              1       6.84e-09  
   531         536      3.00238e-08              1       6.54e-09  
   532         537      3.00185e-08              1       6.23e-09  
   533         538        3.001e-08              1       8.11e-09  
   534         539      3.00022e-08              1        8.8e-09  
   535         540      2.99993e-08              1       9.14e-09  
   536         541      2.99989e-08              1       9.15e-09  
   537         542      2.99989e-08              1       8.96e-09  
   538         543      2.99989e-08              1       8.91e-09  
   539         544      2.99989e-08              1       8.75e-09  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   540         545      2.99988e-08              1       8.53e-09  
   541         546      2.99987e-08              1       8.15e-09  
   542         547      2.99984e-08              1       7.54e-09  
   543         548      2.99977e-08              1       7.38e-09  
   544         549      2.99957e-08              1        7.3e-09  
   545         550      2.99906e-08              1       7.11e-09  
   546         551      2.99785e-08              1       6.63e-09  
   547         552      2.99532e-08              1       8.83e-09  
   548         553      2.99143e-08              1        1.2e-08  
   549         554      2.98807e-08              1       1.21e-08  
   550         555      2.98688e-08              1       1.48e-08  
   551         556      2.98675e-08              1       1.49e-08  
   552         557      2.98674e-08              1       1.48e-08  
   553         558      2.98674e-08              1       1.47e-08  
   554         559      2.98674e-08              1       1.46e-08  
   555         560      2.98673e-08              1       1.45e-08  
   556         561      2.98672e-08              1       1.42e-08  
   557         562      2.98669e-08              1       1.38e-08  
   558         563      2.98661e-08              1       1.31e-08  
   559         564      2.98641e-08              1       1.18e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   560         565      2.98591e-08              1        9.5e-09  
   561         566       2.9848e-08              1       5.59e-09  
   562         567      2.98283e-08              1       2.12e-09  
   563         568      2.98065e-08              1       3.74e-09  
   564         569      2.97954e-08              1       3.43e-09  
   565         570      2.97934e-08              1       2.77e-09  
   566         571      2.97933e-08              1       2.78e-09  
   567         572      2.97933e-08              1       2.77e-09  
   568         573      2.97933e-08              1       2.77e-09  
   569         574      2.97933e-08              1       2.77e-09  
   570         575      2.97933e-08              1       2.76e-09  
   571         576      2.97932e-08              1       2.75e-09  
   572         577      2.97932e-08              1       2.74e-09  
   573         578       2.9793e-08              1       2.71e-09  
   574         579      2.97927e-08              1       2.67e-09  
   575         580      2.97917e-08              1        2.6e-09  
   576         581      2.97892e-08              1       2.47e-09  
   577         582       2.9783e-08              1       3.92e-09  
   578         583      2.97694e-08              1       9.91e-09  
   579         584      2.97457e-08              1       2.07e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   580         585      2.97202e-08              1        3.3e-08  
   581         586      2.97078e-08              1       3.83e-08  
   582         587      2.97057e-08              1       3.73e-08  
   583         588      2.97055e-08              1       3.63e-08  
   584         589      2.97055e-08              1       3.61e-08  
   585         590      2.97054e-08              1       3.55e-08  
   586         591      2.97052e-08              1       3.46e-08  
   587         592      2.97047e-08              1       3.31e-08  
   588         593      2.97034e-08              1       3.07e-08  
   589         594      2.96999e-08              1       2.64e-08  
   590         595      2.96912e-08              1       1.93e-08  
   591         596      2.96713e-08              1          8e-09  
   592         597      2.96331e-08              1       6.69e-09  
   593         598      2.95842e-08              1        1.7e-08  
   594         599      2.95531e-08              1       1.37e-08  
   595         600      2.95457e-08              1       7.21e-09  
   596         601      2.95452e-08              1       7.25e-09  
   597         602      2.95452e-08              1       7.22e-09  
   598         603      2.95452e-08              1       7.21e-09  
   599         604      2.95452e-08              1       7.18e-09  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   600         605      2.95452e-08              1       7.14e-09  
   601         606      2.95451e-08              1       7.07e-09  
   602         607      2.95449e-08              1       6.93e-09  
   603         608      2.95444e-08              1       6.67e-09  
   604         609      2.95432e-08              1       6.13e-09  
   605         610      2.95403e-08              1       5.05e-09  
   606         611      2.95344e-08              1       3.21e-09  
   607         612      2.95254e-08              1       3.85e-09  
   608         613      2.95178e-08              1       2.67e-09  
   609         614      2.95152e-08              1       2.65e-09  
   610         615      2.95149e-08              1        2.5e-09  
   611         616      2.95149e-08              1       2.45e-09  
   612         617      2.95149e-08              1       2.44e-09  
   613         618      2.95149e-08              1       2.43e-09  
   614         619      2.95149e-08              1       2.41e-09  
   615         620      2.95149e-08              1       2.38e-09  
   616         621      2.95149e-08              1       2.32e-09  
   617         622      2.95148e-08              1        2.2e-09  
   618         623      2.95147e-08              1       1.95e-09  
   619         624      2.95144e-08              1       1.52e-09  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   620         625      2.95136e-08              1       1.52e-09  
   621         626      2.95121e-08              1       2.07e-09  
   622         627      2.95096e-08              1       5.53e-09  
   623         628      2.95075e-08              1       8.36e-09  
   624         629      2.95068e-08              1       8.76e-09  
   625         630      2.95067e-08              1       8.23e-09  
   626         631      2.95067e-08              1       8.04e-09  
   627         632      2.95067e-08              1       7.99e-09  
   628         633      2.95067e-08              1       7.83e-09  
   629         634      2.95066e-08              1       7.61e-09  
   630         635      2.95066e-08              1       7.23e-09  
   631         636      2.95065e-08              1       6.63e-09  
   632         637      2.95062e-08              1       5.65e-09  
   633         638      2.95054e-08              1       4.06e-09  
   634         639      2.95034e-08              1       1.49e-09  
   635         640      2.94983e-08              1       2.59e-09  
   636         641      2.94858e-08              1       8.75e-09  
   637         642      2.94575e-08              1       1.68e-08  
   638         643      2.94065e-08              1       2.33e-08  
   639         644      2.93476e-08              1       2.09e-08  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   640         645       2.9316e-08              1       9.53e-09  
   641         646        2.931e-08              1       5.69e-09  
   642         647      2.93096e-08              1       5.55e-09  
   643         648      2.93096e-08              1       5.52e-09  
   644         649      2.93096e-08              1       5.51e-09  
   645         650      2.93096e-08              1        5.5e-09  
   646         651      2.93096e-08              1       5.48e-09  
   647         652      2.93096e-08              1       5.44e-09  
   648         653      2.93095e-08              1       5.37e-09  
   649         654      2.93093e-08              1       5.24e-09  
   650         655      2.93087e-08              1          5e-09  
   651         656      2.93073e-08              1       4.53e-09  
   652         657      2.93039e-08              1        3.6e-09  
   653         658      2.92966e-08              1       3.92e-09  
   654         659      2.92848e-08              1       4.19e-09  
   655         660      2.92736e-08              1        2.8e-09  
   656         661      2.92691e-08              1       2.75e-09  
   657         662      2.92685e-08              1       2.23e-09  
   658         663      2.92685e-08              1       2.06e-09  
   659         664      2.92685e-08              1       2.04e-09  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   660         665      2.92685e-08              1       2.03e-09  
   661         666      2.92685e-08              1       2.01e-09  
   662         667      2.92685e-08              1       1.98e-09  
   663         668      2.92685e-08              1       1.93e-09  
   664         669      2.92685e-08              1       1.92e-09  
   665         670      2.92684e-08              1        1.9e-09  
   666         671      2.92682e-08              1       1.87e-09  
   667         672      2.92676e-08              1       1.82e-09  
   668         673      2.92661e-08              1       1.73e-09  
   669         674      2.92623e-08              1       1.59e-09  
   670         675      2.92524e-08              1       1.88e-09  
   671         676      2.92272e-08              1       4.07e-09  
   672         677      2.91669e-08              1       7.28e-09  
   673         678      2.90397e-08              1       1.08e-08  
   674         679      2.88397e-08              1       1.21e-08  
   675         680      2.86616e-08              1       8.18e-09  
   676         681      2.85956e-08              1       2.88e-09  
   677         682      2.85875e-08              1       2.84e-09  
   678         683      2.85872e-08              1       2.79e-09  
   679         684      2.85872e-08              1       2.78e-09  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   680         685      2.85872e-08              1       2.78e-09  
   681         686      2.85872e-08              1       2.78e-09  
   682         687      2.85872e-08              1       2.78e-09  
   683         688      2.85872e-08              1       2.77e-09  
   684         689      2.85872e-08              1       2.76e-09  
   685         690       2.8587e-08              1       2.74e-09  
   686         691      2.85868e-08              1       2.71e-09  
   687         692       2.8586e-08              1       2.66e-09  
   688         693      2.85842e-08              1       2.57e-09  
   689         694      2.85796e-08              1       2.42e-09  
   690         695       2.8569e-08              1       2.52e-09  
   691         696      2.85489e-08              1       3.14e-09  
   692         697      2.85238e-08              1       4.74e-09  
   693         698      2.85083e-08              1       6.17e-09  
   694         699      2.85048e-08              1       6.09e-09  
   695         700      2.85046e-08              1       5.83e-09  
   696         701      2.85046e-08              1       5.77e-09  
   697         702      2.85046e-08              1       5.77e-09  
   698         703      2.85046e-08              1       5.74e-09  
   699         704      2.85046e-08              1        5.7e-09  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   700         705      2.85045e-08              1       5.63e-09  
   701         706      2.85045e-08              1       5.52e-09  
   702         707      2.85042e-08              1       5.34e-09  
   703         708      2.85036e-08              1       5.04e-09  
   704         709       2.8502e-08              1       4.55e-09  
   705         710      2.84978e-08              1       3.74e-09  
   706         711      2.84874e-08              1        2.4e-09  
   707         712      2.84628e-08              1       1.78e-09  
   708         713      2.84131e-08              1       2.31e-09  
   709         714      2.83418e-08              1       4.18e-09  
   710         715      2.82874e-08              1       3.35e-09  
   711         716      2.82711e-08              1        1.2e-09  
   712         717      2.82695e-08              1       8.85e-10  
   713         718      2.82695e-08              1       8.84e-10  
   714         719      2.82695e-08              1       8.84e-10  
   715         720      2.82695e-08              1       8.83e-10  
   716         721      2.82695e-08              1       8.83e-10  
   717         722      2.82695e-08              1       8.83e-10  
   718         723      2.82695e-08              1       8.82e-10  
   719         724      2.82694e-08              1       8.81e-10  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   720         725      2.82694e-08              1       8.79e-10  
   721         726      2.82693e-08              1       8.75e-10  
   722         727      2.82691e-08              1        8.7e-10  
   723         728      2.82685e-08              1       8.62e-10  
   724         729       2.8267e-08              1       1.06e-09  
   725         730      2.82631e-08              1        1.7e-09  
   726         731      2.82538e-08              1       2.58e-09  
   727         732      2.82344e-08              1       3.49e-09  
   728         733      2.82043e-08              1       3.66e-09  
   729         734      2.81783e-08              1       5.43e-09  
   730         735       2.8169e-08              1       5.77e-09  
   731         736      2.81679e-08              1       5.49e-09  
   732         737      2.81679e-08              1       5.38e-09  
   733         738      2.81679e-08              1       5.37e-09  
   734         739      2.81679e-08              1       5.36e-09  
   735         740      2.81679e-08              1       5.35e-09  
   736         741      2.81679e-08              1       5.32e-09  
   737         742      2.81678e-08              1       5.28e-09  
   738         743      2.81678e-08              1       5.21e-09  
   739         744      2.81676e-08              1        5.1e-09  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   740         745      2.81671e-08              1       4.91e-09  
   741         746      2.81659e-08              1       4.61e-09  
   742         747      2.81628e-08              1       4.12e-09  
   743         748      2.81547e-08              1        3.3e-09  
   744         749      2.81341e-08              1       1.97e-09  
   745         750      2.80837e-08              1        2.3e-09  
   746         751      2.79732e-08              1       3.22e-09  
   747         752      2.77839e-08              1       5.84e-09  
   748         753      2.75868e-08              1       5.99e-09  
   749         754      2.74957e-08              1       3.99e-09  
   750         755      2.74812e-08              1          4e-09  
   751         756      2.74805e-08              1       3.92e-09  
   752         757      2.74805e-08              1       3.91e-09  
   753         758      2.74805e-08              1       3.91e-09  
   754         759      2.74804e-08              1       3.91e-09  
   755         760      2.74804e-08              1        3.9e-09  
   756         761      2.74804e-08              1       3.89e-09  
   757         762      2.74803e-08              1       3.87e-09  
   758         763        2.748e-08              1       3.84e-09  
   759         764      2.74793e-08              1       3.79e-09  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   760         765      2.74774e-08              1       3.71e-09  
   761         766      2.74724e-08              1       3.58e-09  
   762         767        2.746e-08              1       3.35e-09  
   763         768      2.74309e-08              1       3.45e-09  
   764         769      2.73721e-08              1       4.53e-09  
   765         770      2.72883e-08              1        8.3e-09  
   766         771      2.72249e-08              1       1.18e-08  
   767         772      2.72062e-08              1       1.21e-08  
   768         773      2.72044e-08              1       1.15e-08  
   769         774      2.72044e-08              1       1.13e-08  
   770         775      2.72044e-08              1       1.13e-08  
   771         776      2.72043e-08              1       1.12e-08  
   772         777      2.72043e-08              1       1.12e-08  
   773         778      2.72042e-08              1       1.11e-08  
   774         779      2.72041e-08              1       1.09e-08  
   775         780      2.72036e-08              1       1.06e-08  
   776         781      2.72023e-08              1       1.02e-08  
   777         782       2.7199e-08              1       9.48e-09  
   778         783      2.71905e-08              1       8.26e-09  
   779         784       2.7169e-08              1       6.23e-09  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   780         785      2.71176e-08              1       2.97e-09  
   781         786      2.70102e-08              1       1.94e-09  
   782         787      2.68443e-08              1       5.68e-09  
   783         788       2.6701e-08              1       5.75e-09  
   784         789      2.66502e-08              1        2.5e-09  
   785         790      2.66443e-08              1       1.27e-09  
   786         791      2.66441e-08              1       1.27e-09  
   787         792      2.66441e-08              1       1.27e-09  
   788         793      2.66441e-08              1       1.27e-09  
   789         794      2.66441e-08              1       1.27e-09  
   790         795      2.66441e-08              1       1.27e-09  
   791         796      2.66441e-08              1       1.27e-09  
   792         797      2.66441e-08              1       1.27e-09  
   793         798       2.6644e-08              1       1.26e-09  
   794         799      2.66438e-08              1       1.26e-09  
   795         800      2.66432e-08              1       1.25e-09  
   796         801      2.66417e-08              1       1.23e-09  
   797         802      2.66379e-08              1       1.22e-09  
   798         803      2.66281e-08              1        1.8e-09  
   799         804       2.6603e-08              1       2.83e-09  
                       ...
```

We transform the truncated initial condition of our test trajectory according to the obtained change of coordinates, and integrate our reduced order evolution rule to predict the development of the trajectory. 

```matlab:Code
[yRec, etaRec, zRec] = advect(IMInfo, RDInfo, yData);
```

# Evaluation of reduced dynamics

The normalized mean trajectory error NMTE is computed as the average distance of the predicted trajectory to the measured one in the observable space, normalized by the observable vector with maximum norm in the data. 

```matlab:Code
normedTrajDist = computeTrajectoryErrors(yRec, yData);
NMTE = mean(normedTrajDist(indTest))*100 % in percentage
```

```text:Output
NMTE = 
       5.4115

```

We plot the true test set trajectory in the reduced coordinates and compare it to the prediction. 

```matlab:Code
plotReducedCoordinates(etaData(indTest,:), etaRec(indTest,:))
legend({'Test set (truncated)', 'Prediction'})
```

![figure_2.png
](README_images/figure_2.png
)

We also plot the measured and predicted tip displacement. The reduced model seems to do well on previously unseen data, provided that it is close to the 2D manifold.

```matlab:Code
coordPlot = 1;
plotTrajectories(yData(indTest,:), yRec(indTest,:), 'm', 'PlotCoordinate',coordPlot,'DisplayName', {'Test set', 'Prediction'})
xlabel('$t \, [$s$]$','Interpreter','latex')
ylabel(['$a_{ ' num2str(coordPlot) '}$'],'Interpreter','latex')
```

![figure_3.png
](README_images/figure_3.png
)

# Frequency and amplitude dynamics trends in time

```matlab:Code
time = zRec{indTest,1};
amplitudeNormalForm = abs(zRec{indTest,2}(1,:));
instDamping = RDInfo.conjugateDynamics.damping(amplitudeNormalForm);
instFrequency = RDInfo.conjugateDynamics.frequency(amplitudeNormalForm);

fig = customFigure();
yyaxis left
plot(time,instDamping,'Linewidth',2)
ylabel('$c \, [$1/s$]$','Interpreter','latex')
yyaxis right
plot(time,instFrequency,'Linewidth',2)
xlabel('$t \, [$s$]$','Interpreter','latex')
ylabel('$\omega \, [$rad/s$]$','Interpreter','latex')
xlim([0 200])
```

![figure_4.png
](README_images/figure_4.png
)
