This is a preview of the livescript `vonkarmanshellIR.mlx`.

# Shallow-curved shell structure with geometric nonlinearities
  

See [1] for the details of this model, and [2] for the description of this example.

[1] Jain, S., \& Tiso, P. (2018). Simulation-free hyper-reduction for geometrically nonlinear structural dynamics: a quadratic manifold lifting approach. *Journal of Computational and Nonlinear Dynamics*, *13*(7), 071003. [https://doi.org/10.1115/1.4040021](https://doi.org/10.1115/1.4040021)

[2] Cenedese, M., Marconi, J., Haller, G., \& Jain, S. (2023). Data-assisted non-intrusive model reduction for forced nonlinear finite elements models. Preprint: [arXiv: 2311.17865](https://arxiv.org/abs/2311.17865) 

The finite element code taken from the following package:

Jain, S., Marconi, J., Tiso P. (2020). YetAnotherFEcode (Version v1.1). Zenodo. [http://doi.org/10.5281/zenodo.4011282](http://doi.org/10.5281/zenodo.4011282)

![image_0.png
](README_images/image_0.png
)

# Example setup

The $N$-degree of freedom dynamical system is of the form

$$
{M\ddot{q} }+{C\dot{q} }+{Kq}+f(q,{\dot{q} })=0
$$

where $f=\mathcal{O}(|q|^2 ,|{\dot{q} }|^2 ,|q||{\dot{q} }|)$ represents the nonlinearities and $M$, $C$, and $K$ are the $n\times n$ mass, stiffness, and damping matrices, respectively.

We rewrite the system in first-order form as

$$
{\dot{x} }=Ax+G(x)=F(x)
$$

with

$x=\left\lbrack \begin{array}{c}
q\\
\dot{q} 
\end{array}\right\rbrack ,~~A=\left\lbrack \begin{array}{cc}
0 & I\\
-M^{-1} K & -M^{-1} C
\end{array}\right\rbrack ,~~G(x)=\left\lbrack \begin{array}{c}
0\\
-M^{-1} f(x)
\end{array}\right\rbrack$.

```matlab:Code
clearvars 
close all
clc

% Setup colors
colors = colororder; colSSMT = 5; colSSML = 7; colFOM = 1;
```

# Generate model

```matlab:Code
nDiscretization = 10; % Discretization parameter (#DOFs is proportional to the square of this number)
epsilon = 0.1; % converge at order 5
[M,C,K,fnl,f_0,outdof,Model] = buildModel(nDiscretization);
```

```text:Output
Building FE model
```

![figure_0.png
](README_images/figure_0.png
)

```text:Output
Assembling M,C,K matrices
Applying boundary conditions
Solving undamped eigenvalue problem
```

![figure_1.png
](README_images/figure_1.png
)

![figure_2.png
](README_images/figure_2.png
)

```text:Output
Using Rayleigh damping
a = 2x1    
    0.0000
    0.3981

Assembling external force vector
Getting nonlinearity coefficients
Loaded tensors from storage
Total time spent on model assembly = 00:00:16
```

```matlab:Code
n = length(M); % number of degrees of freedom
disp(['Number of degrees of freedom = ' num2str(n)])
```

```text:Output
Number of degrees of freedom = 1320
```

```matlab:Code
disp(['Phase space dimensionality = ' num2str(2*n)])
```

```text:Output
Phase space dimensionality = 2640
```

# Linear modal analysis

```matlab:Code
if ~isfile('linpart.mat')
    m = 10;
    [W,A,V,lambda] = linearpart(M,C,K,m);
    save('linpart.mat',"W","A","V","lambda")
else
    load('linpart.mat')
end
```

# Define master modes and linear part of the dynamics 

```matlab:Code
masterModes = [1 3 2 4]; % Modal displacements and modal velocities
Ve = V(:,masterModes); % Mode shape
We = W(masterModes,:); % Projection to mode shape
Ae = full(We*A*Ve) % Reduced, linearized dynamics
```

```text:Output
Ae = 4x4    
1.0e+04 *

         0         0    0.0001    0.0000
         0         0    0.0000    0.0001
   -2.2268   -0.0000   -0.0001   -0.0000
   -0.0000   -8.9270    0.0000   -0.0001

```

```matlab:Code
SSMDim = length(masterModes);

displacementVector = zeros(1,n); displacementVector(outdof) = 1;
loadVector = f_0;  %  could also be set as modal ones
```

# Compare linear and nonlinear response via modal displacement

Displacement along the first mode

```matlab:Code
iMode = 1; scalingfactor1 = 1e-1; nsteps = 50; outdof1 = outdof(1);
[phi1, relativeDiffForceNorm] = modal_analysis(Model,scalingfactor1,nsteps,outdof1,true,iMode);
```

```text:Output
Solving undamped eigenvalue problem
Mode shape
   -0.0941
    0.0007
   -0.0002
   -0.0884
    0.0003
   -0.0000
   -0.0855
    0.0003
   -0.0000
   -0.0840
    0.0003
   -0.0000
   -0.0833
    0.0002
   -0.0000
   -0.0831
    0.0002
   -0.0000
   -0.0832
    0.0003
   -0.0000
   -0.0839
    0.0003
   -0.0000
   -0.0853
    0.0003
    0.0000
   -0.0878
    0.0005
    0.0000
   -0.0920
    0.0004
    0.0002
    0.0000
    0.0007
    0.0092
   -0.0886
    0.0068
   -0.0005
   -0.0000
    0.0007
    0.0087
   -0.0839
    0.0041
   -0.0003
   -0.0000
    0.0007
    0.0084
   -0.0813
    0.0024
   -0.0002
   -0.0000
    0.0006
    0.0082
   -0.0798
    0.0013
   -0.0001
   -0.0000
    0.0006
    0.0082
   -0.0791
    0.0007
   -0.0000
   -0.0000
    0.0006
    0.0081
   -0.0789
    0.0002
   -0.0000
    0.0000
    0.0006
    0.0082
   -0.0791
   -0.0001
    0.0000
    0.0000
    0.0006
    0.0082
   -0.0797
   -0.0007
    0.0001
    0.0000
    0.0007
    0.0084
   -0.0811
   -0.0016
    0.0001
    0.0000
    0.0007
    0.0086
   -0.0837
   -0.0031
    0.0002
   -0.0000
    0.0007
    0.0091
   -0.0885
   -0.0055
    0.0004
    0.0000
    0.0013
    0.0174
   -0.0751
    0.0122
   -0.0008
   -0.0000
    0.0012
    0.0165
   -0.0712
    0.0074
   -0.0005
   -0.0000
    0.0012
    0.0159
   -0.0690
    0.0042
   -0.0003
   -0.0000
    0.0012
    0.0157
   -0.0677
    0.0022
   -0.0001
   -0.0000
    0.0012
    0.0155
   -0.0672
    0.0010
   -0.0001
   -0.0000
    0.0012
    0.0155
   -0.0670
    0.0002
   -0.0000
    0.0000
    0.0012
    0.0155
   -0.0672
   -0.0005
    0.0000
    0.0000
    0.0012
    0.0156
   -0.0678
   -0.0017
    0.0001
    0.0000
    0.0012
    0.0159
   -0.0691
   -0.0035
    0.0002
   -0.0000
    0.0012
    0.0164
   -0.0716
   -0.0065
    0.0004
   -0.0000
    0.0013
    0.0173
   -0.0757
   -0.0112
    0.0007
    0.0000
    0.0017
    0.0240
   -0.0544
    0.0164
   -0.0010
    0.0000
    0.0016
    0.0227
   -0.0516
    0.0099
   -0.0006
   -0.0000
    0.0016
    0.0219
   -0.0499
    0.0056
   -0.0003
   -0.0000
    0.0015
    0.0215
   -0.0490
    0.0029
   -0.0002
   -0.0000
    0.0015
    0.0213
   -0.0486
    0.0013
   -0.0001
   -0.0000
    0.0015
    0.0213
   -0.0485
    0.0001
   -0.0000
   -0.0000
    0.0015
    0.0213
   -0.0487
   -0.0010
    0.0000
   -0.0000
    0.0015
    0.0215
   -0.0493
   -0.0025
    0.0001
   -0.0000
    0.0015
    0.0219
   -0.0504
   -0.0052
    0.0003
   -0.0000
    0.0016
    0.0227
   -0.0523
   -0.0094
    0.0005
   -0.0000
    0.0017
    0.0239
   -0.0554
   -0.0160
    0.0009
    0.0000
    0.0019
    0.0281
   -0.0284
    0.0192
   -0.0010
    0.0000
    0.0018
    0.0266
   -0.0269
    0.0115
   -0.0006
   -0.0000
    0.0018
    0.0258
   -0.0260
    0.0065
   -0.0003
   -0.0000
    0.0017
    0.0253
   -0.0256
    0.0033
   -0.0002
   -0.0000
    0.0017
    0.0251
   -0.0254
    0.0014
   -0.0001
   -0.0000
    0.0017
    0.0250
   -0.0254
    0.0000
   -0.0000
   -0.0000
    0.0017
    0.0251
   -0.0256
   -0.0013
    0.0001
   -0.0000
    0.0017
    0.0253
   -0.0260
   -0.0033
    0.0001
   -0.0000
    0.0018
    0.0258
   -0.0267
   -0.0064
    0.0003
   -0.0000
    0.0018
    0.0267
   -0.0278
   -0.0114
    0.0005
   -0.0000
    0.0019
    0.0282
   -0.0295
   -0.0191
    0.0009
    0.0000
    0.0019
    0.0296
    0.0004
    0.0200
   -0.0009
    0.0000
    0.0019
    0.0280
    0.0004
    0.0120
   -0.0005
    0.0000
    0.0018
    0.0271
    0.0004
    0.0067
   -0.0003
   -0.0000
    0.0018
    0.0266
    0.0003
    0.0034
   -0.0001
   -0.0000
    0.0018
    0.0263
    0.0002
    0.0014
   -0.0001
   -0.0000
    0.0018
    0.0263
    0.0002
   -0.0001
    0.0000
   -0.0000
    0.0018
    0.0264
    0.0001
   -0.0016
    0.0001
   -0.0000
    0.0018
    0.0266
   -0.0001
   -0.0037
    0.0001
   -0.0000
    0.0018
    0.0271
   -0.0003
   -0.0070
    0.0003
   -0.0000
    0.0019
    0.0281
   -0.0005
   -0.0123
    0.0005
   -0.0000
    0.0019
    0.0297
   -0.0007
   -0.0204
    0.0008
    0.0000
    0.0018
    0.0281
    0.0292
    0.0189
   -0.0007
    0.0000
    0.0018
    0.0266
    0.0277
    0.0113
   -0.0004
    0.0000
    0.0018
    0.0257
    0.0267
    0.0063
   -0.0002
   -0.0000
    0.0017
    0.0252
    0.0261
    0.0031
   -0.0001
   -0.0000
    0.0017
    0.0250
    0.0258
    0.0012
   -0.0000
   -0.0000
    0.0017
    0.0250
    0.0257
   -0.0003
    0.0000
   -0.0000
    0.0017
    0.0251
    0.0257
   -0.0017
    0.0001
   -0.0000
    0.0017
    0.0253
    0.0258
   -0.0037
    0.0001
   -0.0000
    0.0018
    0.0258
    0.0261
   -0.0069
    0.0002
   -0.0000
    0.0018
    0.0267
    0.0269
   -0.0120
    0.0004
   -0.0000
    0.0019
    0.0283
    0.0283
   -0.0196
    0.0006
    0.0000
    0.0017
    0.0239
    0.0551
    0.0160
   -0.0004
    0.0000
    0.0017
    0.0226
    0.0522
    0.0094
   -0.0002
   -0.0000
    0.0017
    0.0218
    0.0504
    0.0052
   -0.0001
   -0.0000
    0.0016
    0.0215
    0.0494
    0.0025
   -0.0001
   -0.0000
    0.0016
    0.0213
    0.0489
    0.0009
   -0.0000
   -0.0000
    0.0016
    0.0212
    0.0487
   -0.0004
    0.0000
   -0.0000
    0.0016
    0.0213
    0.0487
   -0.0016
    0.0000
   -0.0000
    0.0016
    0.0215
    0.0491
   -0.0034
    0.0001
   -0.0000
    0.0017
    0.0220
    0.0500
   -0.0061
    0.0002
   -0.0000
    0.0017
    0.0228
    0.0516
   -0.0104
    0.0003
   -0.0000
    0.0017
    0.0241
    0.0545
   -0.0169
    0.0004
    0.0000
    0.0016
    0.0173
    0.0756
    0.0114
   -0.0002
   -0.0000
    0.0016
    0.0164
    0.0715
    0.0067
   -0.0001
   -0.0000
    0.0015
    0.0158
    0.0691
    0.0036
   -0.0001
   -0.0000
    0.0015
    0.0156
    0.0678
    0.0017
   -0.0001
   -0.0000
    0.0015
    0.0154
    0.0671
    0.0004
   -0.0000
   -0.0000
    0.0015
    0.0154
    0.0669
   -0.0005
    0.0000
   -0.0000
    0.0015
    0.0155
    0.0671
   -0.0014
    0.0000
   -0.0000
    0.0015
    0.0157
    0.0677
   -0.0027
    0.0001
   -0.0000
    0.0015
    0.0160
    0.0689
   -0.0047
    0.0001
   -0.0000
    0.0016
    0.0166
    0.0713
   -0.0078
    0.0002
   -0.0000
    0.0016
    0.0176
    0.0754
   -0.0125
    0.0002
   -0.0000
    0.0015
    0.0090
    0.0887
    0.0057
   -0.0001
   -0.0000
    0.0015
    0.0086
    0.0839
    0.0032
   -0.0001
   -0.0000
    0.0014
    0.0083
    0.0811
    0.0016
   -0.0000
   -0.0000
    0.0014
    0.0082
    0.0796
    0.0006
   -0.0000
   -0.0000
    0.0014
    0.0081
    0.0788
   -0.0000
   -0.0000
   -0.0000
    0.0014
    0.0081
    0.0786
   -0.0005
    0.0000
   -0.0000
    0.0014
    0.0082
    0.0788
   -0.0010
    0.0000
   -0.0000
    0.0014
    0.0083
    0.0796
   -0.0017
    0.0000
   -0.0000
    0.0014
    0.0085
    0.0812
   -0.0027
    0.0001
   -0.0000
    0.0015
    0.0088
    0.0840
   -0.0044
    0.0001
   -0.0000
    0.0015
    0.0093
    0.0889
   -0.0069
    0.0001
   -0.0000
    0.0014
   -0.0001
    0.0930
   -0.0005
   -0.0000
   -0.0000
    0.0014
   -0.0001
    0.0881
   -0.0006
   -0.0000
   -0.0000
    0.0014
   -0.0001
    0.0852
   -0.0005
   -0.0000
   -0.0000
    0.0014
   -0.0000
    0.0836
   -0.0005
   -0.0000
   -0.0000
    0.0014
   -0.0000
    0.0828
   -0.0005
   -0.0000
   -0.0000
    0.0014
   -0.0000
    0.0826
   -0.0005
    0.0000
   -0.0000
    0.0014
    0.0000
    0.0829
   -0.0005
    0.0000
   -0.0000
    0.0014
    0.0000
    0.0838
   -0.0005
    0.0000
   -0.0000
    0.0014
    0.0001
    0.0855
   -0.0005
    0.0000
   -0.0000
    0.0014
    0.0001
    0.0885
   -0.0006
    0.0000
   -0.0000
    0.0014
    0.0001
    0.0936
   -0.0005
    0.0000
   -0.0000
    0.0015
   -0.0092
    0.0883
   -0.0067
   -0.0001
   -0.0000
    0.0015
   -0.0087
    0.0836
   -0.0043
   -0.0001
   -0.0000
    0.0014
   -0.0084
    0.0809
   -0.0026
   -0.0001
   -0.0000
    0.0014
   -0.0082
    0.0794
   -0.0016
   -0.0000
   -0.0000
    0.0014
   -0.0081
    0.0788
   -0.0009
   -0.0000
   -0.0000
    0.0014
   -0.0081
    0.0786
   -0.0004
    0.0000
   -0.0000
    0.0014
   -0.0081
    0.0789
    0.0001
    0.0000
   -0.0000
    0.0014
   -0.0082
    0.0798
    0.0007
    0.0000
   -0.0000
    0.0014
   -0.0083
    0.0814
    0.0017
    0.0001
   -0.0000
    0.0015
   -0.0086
    0.0843
    0.0033
    0.0001
    0.0000
    0.0015
   -0.0091
    0.0892
    0.0059
    0.0001
   -0.0000
    0.0016
   -0.0175
    0.0749
   -0.0122
   -0.0002
   -0.0000
    0.0015
   -0.0165
    0.0710
   -0.0075
   -0.0001
   -0.0000
    0.0015
   -0.0160
    0.0687
   -0.0044
   -0.0001
   -0.0000
    0.0015
   -0.0156
    0.0675
   -0.0024
   -0.0001
   -0.0000
    0.0015
   -0.0155
    0.0670
   -0.0012
   -0.0000
   -0.0000
    0.0015
   -0.0154
    0.0669
   -0.0003
    0.0000
   -0.0000
    0.0015
   -0.0155
    0.0672
    0.0006
    0.0000
   -0.0000
    0.0015
   -0.0156
    0.0679
    0.0019
    0.0001
    0.0000
    0.0015
   -0.0159
    0.0694
    0.0038
    0.0001
    0.0000
    0.0016
   -0.0165
    0.0719
    0.0069
    0.0001
    0.0000
    0.0016
   -0.0174
    0.0761
    0.0117
    0.0002
   -0.0000
    0.0017
   -0.0240
    0.0542
   -0.0165
   -0.0004
   -0.0000
    0.0017
   -0.0227
    0.0514
   -0.0100
   -0.0003
   -0.0000
    0.0017
   -0.0219
    0.0498
   -0.0058
   -0.0002
   -0.0000
    0.0016
   -0.0215
    0.0490
   -0.0031
   -0.0001
   -0.0000
    0.0016
   -0.0213
    0.0487
   -0.0014
   -0.0000
   -0.0000
    0.0016
   -0.0212
    0.0487
   -0.0001
    0.0000
   -0.0000
    0.0016
   -0.0213
    0.0489
    0.0011
    0.0000
    0.0000
    0.0016
   -0.0215
    0.0495
    0.0028
    0.0001
    0.0000
    0.0017
   -0.0219
    0.0505
    0.0055
    0.0002
    0.0000
    0.0017
   -0.0227
    0.0524
    0.0098
    0.0003
    0.0000
    0.0017
   -0.0240
    0.0554
    0.0164
    0.0004
   -0.0000
    0.0018
   -0.0281
    0.0282
   -0.0192
   -0.0006
   -0.0000
    0.0018
   -0.0266
    0.0267
   -0.0115
   -0.0004
   -0.0000
    0.0018
   -0.0257
    0.0260
   -0.0065
   -0.0002
   -0.0000
    0.0017
   -0.0253
    0.0257
   -0.0034
   -0.0001
   -0.0000
    0.0017
   -0.0250
    0.0256
   -0.0014
   -0.0000
   -0.0000
    0.0017
   -0.0250
    0.0257
    0.0000
    0.0000
    0.0000
    0.0017
   -0.0251
    0.0258
    0.0015
    0.0001
    0.0000
    0.0018
   -0.0253
    0.0262
    0.0034
    0.0001
    0.0000
    0.0018
   -0.0258
    0.0267
    0.0066
    0.0002
    0.0000
    0.0018
   -0.0267
    0.0278
    0.0117
    0.0004
    0.0000
    0.0019
   -0.0283
    0.0293
    0.0194
    0.0007
   -0.0000
    0.0019
   -0.0295
   -0.0006
   -0.0199
   -0.0008
   -0.0000
    0.0018
   -0.0280
   -0.0005
   -0.0119
   -0.0005
   -0.0000
    0.0018
   -0.0270
   -0.0003
   -0.0066
   -0.0003
   -0.0000
    0.0018
   -0.0266
   -0.0001
   -0.0033
   -0.0001
   -0.0000
    0.0018
   -0.0263
    0.0001
   -0.0013
   -0.0000
   -0.0000
    0.0018
   -0.0263
    0.0002
    0.0002
    0.0000
    0.0000
    0.0018
   -0.0264
    0.0002
    0.0016
    0.0001
    0.0000
    0.0018
   -0.0266
    0.0003
    0.0037
    0.0002
    0.0000
    0.0018
   -0.0272
    0.0003
    0.0071
    0.0003
    0.0000
    0.0019
   -0.0281
    0.0004
    0.0124
    0.0005
    0.0000
    0.0019
   -0.0297
    0.0004
    0.0205
    0.0009
   -0.0000
    0.0019
   -0.0280
   -0.0293
   -0.0187
   -0.0009
   -0.0000
    0.0018
   -0.0266
   -0.0276
   -0.0110
   -0.0005
   -0.0000
    0.0018
   -0.0257
   -0.0265
   -0.0060
   -0.0003
   -0.0000
    0.0017
   -0.0253
   -0.0259
   -0.0030
   -0.0001
   -0.0000
    0.0017
   -0.0251
   -0.0255
   -0.0011
   -0.0000
   -0.0000
    0.0017
   -0.0250
   -0.0254
    0.0003
    0.0000
    0.0000
    0.0017
   -0.0251
   -0.0254
    0.0017
    0.0001
    0.0000
    0.0017
   -0.0253
   -0.0257
    0.0036
    0.0002
    0.0000
    0.0018
   -0.0258
   -0.0262
    0.0068
    0.0003
    0.0000
    0.0018
   -0.0268
   -0.0271
    0.0119
    0.0006
    0.0000
    0.0019
   -0.0283
   -0.0286
    0.0196
    0.0010
   -0.0000
    0.0016
   -0.0238
   -0.0550
   -0.0156
   -0.0008
   -0.0000
    0.0016
   -0.0226
   -0.0520
   -0.0091
   -0.0005
   -0.0000
    0.0015
   -0.0219
   -0.0502
   -0.0049
   -0.0003
    0.0000
    0.0015
   -0.0215
   -0.0492
   -0.0023
   -0.0001
    0.0000
    0.0015
   -0.0213
   -0.0487
   -0.0008
   -0.0000
    0.0000
    0.0015
   -0.0213
   -0.0485
    0.0003
    0.0000
    0.0000
    0.0015
   -0.0214
   -0.0487
    0.0015
    0.0001
    0.0000
    0.0015
   -0.0216
   -0.0492
    0.0031
    0.0002
    0.0000
    0.0016
   -0.0220
   -0.0501
    0.0059
    0.0003
    0.0000
    0.0016
   -0.0228
   -0.0518
    0.0103
    0.0006
    0.0000
    0.0017
   -0.0241
   -0.0548
    0.0168
    0.0010
   -0.0000
    0.0013
   -0.0173
   -0.0753
   -0.0110
   -0.0007
    0.0000
    0.0012
   -0.0164
   -0.0713
   -0.0063
   -0.0004
    0.0000
    0.0012
   -0.0159
   -0.0689
   -0.0033
   -0.0002
    0.0000
    0.0012
   -0.0156
   -0.0677
   -0.0015
   -0.0001
    0.0000
    0.0012
   -0.0155
   -0.0671
   -0.0004
   -0.0000
    0.0000
    0.0012
   -0.0155
   -0.0670
    0.0004
    0.0000
   -0.0000
    0.0012
   -0.0155
   -0.0672
    0.0012
    0.0001
   -0.0000
    0.0012
   -0.0157
   -0.0679
    0.0024
    0.0001
   -0.0000
    0.0012
   -0.0160
   -0.0692
    0.0044
    0.0003
    0.0000
    0.0012
   -0.0166
   -0.0716
    0.0076
    0.0005
    0.0000
    0.0013
   -0.0175
   -0.0756
    0.0124
    0.0008
   -0.0000
    0.0007
   -0.0090
   -0.0880
   -0.0054
   -0.0004
    0.0000
    0.0007
   -0.0086
   -0.0834
   -0.0030
   -0.0002
    0.0000
    0.0007
   -0.0083
   -0.0809
   -0.0015
   -0.0001
    0.0000
    0.0006
   -0.0082
   -0.0796
   -0.0006
   -0.0001
    0.0000
    0.0006
   -0.0082
   -0.0790
   -0.0001
   -0.0000
    0.0000
    0.0006
   -0.0081
   -0.0789
    0.0003
    0.0000
   -0.0000
    0.0006
   -0.0082
   -0.0792
    0.0007
    0.0000
   -0.0000
    0.0006
   -0.0083
   -0.0799
    0.0014
    0.0001
   -0.0000
    0.0007
   -0.0084
   -0.0815
    0.0025
    0.0002
   -0.0000
    0.0007
   -0.0087
   -0.0843
    0.0043
    0.0003
    0.0000
    0.0007
   -0.0092
   -0.0890
    0.0070
    0.0005
   -0.0915
    0.0004
   -0.0002
   -0.0875
    0.0005
   -0.0000
   -0.0850
    0.0003
   -0.0000
   -0.0837
    0.0003
    0.0000
   -0.0832
    0.0003
    0.0000
   -0.0831
    0.0002
    0.0000
   -0.0833
    0.0002
    0.0000
   -0.0841
    0.0003
    0.0000
   -0.0857
    0.0003
    0.0000
   -0.0888
    0.0003
    0.0000
   -0.0945
    0.0007
    0.0002

Eigenfrequency
  149.2239
```

![figure_3.png
](README_images/figure_3.png
)

![figure_4.png
](README_images/figure_4.png
)

![figure_5.png
](README_images/figure_5.png
)

![figure_6.png
](README_images/figure_6.png
)

```text:Output
Displacement at output DOF: -0.0026277
```

Pick up two initial trajectories that has high expected nonlinear content

```matlab:Code
indIC1 = [nsteps, nsteps-1];
IC1 = [phi1*(scalingfactor1*indIC1/nsteps);zeros(n,length(indIC1))];
```

Displacement along the second mode

```matlab:Code
iMode = 2; scalingfactor2 = 1e-1; nsteps = 50; outdof2 = outdof(2);
[phi2, relativeDiffForceNorm2] = modal_analysis(Model,scalingfactor2,nsteps,outdof2,true,iMode);
```

```text:Output
Solving undamped eigenvalue problem
Mode shape
    0.0745
   -0.0016
   -0.0004
    0.0655
   -0.0006
    0.0001
    0.0619
   -0.0007
    0.0002
    0.0603
   -0.0006
    0.0001
    0.0599
   -0.0006
    0.0001
    0.0601
   -0.0006
    0.0001
    0.0607
   -0.0006
    0.0001
    0.0617
   -0.0006
    0.0001
    0.0635
   -0.0005
    0.0000
    0.0669
   -0.0011
    0.0002
    0.0728
   -0.0008
    0.0013
    0.0000
   -0.0006
   -0.0069
    0.0606
   -0.0111
    0.0012
    0.0000
   -0.0005
   -0.0061
    0.0545
   -0.0057
    0.0004
    0.0000
   -0.0005
   -0.0058
    0.0517
   -0.0028
    0.0002
    0.0000
   -0.0005
   -0.0056
    0.0505
   -0.0013
    0.0001
    0.0000
   -0.0005
   -0.0056
    0.0502
   -0.0005
    0.0001
    0.0000
   -0.0005
   -0.0056
    0.0503
   -0.0001
    0.0000
   -0.0000
   -0.0005
   -0.0057
    0.0507
    0.0002
   -0.0000
   -0.0000
   -0.0005
   -0.0058
    0.0516
    0.0008
   -0.0001
   -0.0000
   -0.0005
   -0.0059
    0.0532
    0.0018
   -0.0002
   -0.0000
   -0.0005
   -0.0063
    0.0564
    0.0039
   -0.0005
   -0.0000
   -0.0006
   -0.0070
    0.0633
    0.0090
   -0.0010
    0.0001
   -0.0010
   -0.0115
    0.0293
   -0.0176
    0.0013
    0.0000
   -0.0009
   -0.0103
    0.0260
   -0.0087
    0.0007
    0.0000
   -0.0008
   -0.0097
    0.0246
   -0.0040
    0.0003
    0.0000
   -0.0008
   -0.0095
    0.0241
   -0.0016
    0.0001
    0.0000
   -0.0008
   -0.0094
    0.0240
   -0.0004
    0.0000
    0.0000
   -0.0008
   -0.0094
    0.0242
    0.0003
   -0.0000
   -0.0000
   -0.0008
   -0.0095
    0.0244
    0.0009
   -0.0001
   -0.0000
   -0.0008
   -0.0097
    0.0250
    0.0019
   -0.0002
   -0.0000
   -0.0008
   -0.0100
    0.0260
    0.0038
   -0.0004
   -0.0000
   -0.0009
   -0.0106
    0.0282
    0.0081
   -0.0007
   -0.0001
   -0.0010
   -0.0118
    0.0324
    0.0171
   -0.0012
    0.0001
   -0.0010
   -0.0124
   -0.0119
   -0.0197
    0.0012
    0.0000
   -0.0010
   -0.0110
   -0.0119
   -0.0094
    0.0006
    0.0000
   -0.0009
   -0.0104
   -0.0115
   -0.0040
    0.0003
    0.0000
   -0.0009
   -0.0101
   -0.0112
   -0.0014
    0.0001
    0.0000
   -0.0009
   -0.0101
   -0.0110
   -0.0001
    0.0000
    0.0000
   -0.0009
   -0.0101
   -0.0108
    0.0007
   -0.0001
   -0.0000
   -0.0009
   -0.0102
   -0.0108
    0.0013
   -0.0001
   -0.0000
   -0.0009
   -0.0104
   -0.0108
    0.0025
   -0.0002
   -0.0000
   -0.0009
   -0.0107
   -0.0107
    0.0049
   -0.0004
   -0.0001
   -0.0010
   -0.0115
   -0.0104
    0.0101
   -0.0007
   -0.0001
   -0.0011
   -0.0130
   -0.0100
    0.0206
   -0.0012
    0.0001
   -0.0009
   -0.0092
   -0.0537
   -0.0170
    0.0009
    0.0001
   -0.0008
   -0.0079
   -0.0502
   -0.0077
    0.0004
    0.0000
   -0.0008
   -0.0074
   -0.0481
   -0.0029
    0.0002
    0.0000
   -0.0008
   -0.0072
   -0.0470
   -0.0007
    0.0001
    0.0000
   -0.0008
   -0.0072
   -0.0465
    0.0004
   -0.0000
   -0.0000
   -0.0008
   -0.0072
   -0.0464
    0.0009
   -0.0001
   -0.0000
   -0.0008
   -0.0073
   -0.0467
    0.0013
   -0.0001
   -0.0000
   -0.0008
   -0.0075
   -0.0472
    0.0023
   -0.0002
   -0.0000
   -0.0008
   -0.0078
   -0.0483
    0.0045
   -0.0003
   -0.0001
   -0.0009
   -0.0084
   -0.0501
    0.0093
   -0.0006
   -0.0001
   -0.0010
   -0.0097
   -0.0537
    0.0188
   -0.0010
    0.0001
   -0.0006
   -0.0021
   -0.0868
   -0.0101
    0.0005
    0.0001
   -0.0006
   -0.0013
   -0.0805
   -0.0038
    0.0002
    0.0000
   -0.0006
   -0.0011
   -0.0771
   -0.0008
    0.0001
    0.0000
   -0.0006
   -0.0010
   -0.0755
    0.0004
    0.0000
    0.0000
   -0.0006
   -0.0011
   -0.0748
    0.0008
   -0.0000
   -0.0000
   -0.0006
   -0.0011
   -0.0748
    0.0008
   -0.0001
   -0.0000
   -0.0006
   -0.0011
   -0.0753
    0.0009
   -0.0001
   -0.0000
   -0.0006
   -0.0012
   -0.0764
    0.0013
   -0.0001
   -0.0000
   -0.0006
   -0.0013
   -0.0785
    0.0026
   -0.0002
   -0.0001
   -0.0006
   -0.0017
   -0.0821
    0.0057
   -0.0003
   -0.0001
   -0.0007
   -0.0025
   -0.0889
    0.0120
   -0.0006
    0.0001
   -0.0003
    0.0076
   -0.1041
   -0.0003
    0.0000
    0.0001
   -0.0003
    0.0076
   -0.0964
    0.0014
   -0.0000
    0.0000
   -0.0003
    0.0075
   -0.0923
    0.0019
   -0.0000
    0.0000
   -0.0003
    0.0074
   -0.0904
    0.0017
   -0.0000
    0.0000
   -0.0003
    0.0073
   -0.0897
    0.0012
   -0.0000
   -0.0000
   -0.0003
    0.0072
   -0.0898
    0.0006
   -0.0001
   -0.0000
   -0.0003
    0.0072
   -0.0905
   -0.0000
   -0.0001
   -0.0000
   -0.0003
    0.0073
   -0.0920
   -0.0004
   -0.0001
   -0.0001
   -0.0003
    0.0074
   -0.0948
   -0.0005
   -0.0001
   -0.0001
   -0.0003
    0.0075
   -0.0996
    0.0000
   -0.0001
   -0.0001
   -0.0004
    0.0075
   -0.1083
    0.0016
   -0.0001
    0.0001
   -0.0001
    0.0180
   -0.1019
    0.0103
   -0.0003
    0.0001
   -0.0001
    0.0172
   -0.0942
    0.0070
   -0.0001
    0.0000
   -0.0001
    0.0167
   -0.0904
    0.0046
   -0.0001
    0.0000
   -0.0001
    0.0164
   -0.0886
    0.0028
   -0.0001
    0.0000
   -0.0001
    0.0162
   -0.0880
    0.0014
   -0.0000
   -0.0000
   -0.0001
    0.0162
   -0.0882
    0.0001
   -0.0000
   -0.0000
   -0.0001
    0.0163
   -0.0891
   -0.0012
   -0.0000
   -0.0000
   -0.0001
    0.0166
   -0.0907
   -0.0025
   -0.0000
   -0.0001
   -0.0001
    0.0169
   -0.0936
   -0.0042
    0.0000
   -0.0001
   -0.0001
    0.0175
   -0.0986
   -0.0066
    0.0001
   -0.0001
   -0.0001
    0.0185
   -0.1075
   -0.0103
    0.0002
    0.0001
    0.0001
    0.0272
   -0.0802
    0.0196
   -0.0004
    0.0001
    0.0000
    0.0258
   -0.0742
    0.0117
   -0.0002
    0.0000
    0.0000
    0.0249
   -0.0713
    0.0068
   -0.0001
    0.0000
    0.0000
    0.0244
   -0.0701
    0.0037
   -0.0001
    0.0000
    0.0000
    0.0242
   -0.0698
    0.0014
   -0.0000
   -0.0000
    0.0000
    0.0242
   -0.0701
   -0.0005
   -0.0000
   -0.0000
    0.0000
    0.0244
   -0.0709
   -0.0024
   -0.0000
   -0.0001
    0.0000
    0.0248
   -0.0724
   -0.0047
    0.0000
   -0.0001
    0.0000
    0.0255
   -0.0749
   -0.0079
    0.0000
   -0.0001
    0.0000
    0.0265
   -0.0791
   -0.0129
    0.0001
   -0.0001
    0.0000
    0.0283
   -0.0864
   -0.0213
    0.0002
    0.0001
    0.0001
    0.0335
   -0.0432
    0.0258
   -0.0003
    0.0001
    0.0001
    0.0316
   -0.0401
    0.0147
   -0.0001
    0.0000
    0.0000
    0.0305
   -0.0388
    0.0081
   -0.0001
    0.0000
    0.0000
    0.0299
   -0.0383
    0.0040
   -0.0000
    0.0000
    0.0000
    0.0297
   -0.0384
    0.0011
   -0.0000
   -0.0000
    0.0000
    0.0297
   -0.0387
   -0.0012
   -0.0000
   -0.0000
    0.0000
    0.0300
   -0.0393
   -0.0035
   -0.0000
   -0.0001
    0.0000
    0.0305
   -0.0404
   -0.0064
    0.0000
   -0.0001
    0.0000
    0.0314
   -0.0420
   -0.0107
    0.0000
   -0.0001
    0.0000
    0.0328
   -0.0447
   -0.0175
    0.0001
   -0.0001
    0.0001
    0.0351
   -0.0489
   -0.0292
    0.0001
    0.0001
    0.0000
    0.0356
    0.0021
    0.0275
   -0.0001
    0.0001
    0.0000
    0.0335
    0.0017
    0.0153
   -0.0000
    0.0000
    0.0000
    0.0324
    0.0012
    0.0081
   -0.0000
    0.0000
    0.0000
    0.0318
    0.0007
    0.0037
   -0.0000
    0.0000
    0.0000
    0.0316
    0.0004
    0.0007
   -0.0000
   -0.0000
    0.0000
    0.0317
    0.0000
   -0.0018
   -0.0000
   -0.0000
   -0.0000
    0.0320
   -0.0003
   -0.0043
   -0.0000
   -0.0001
   -0.0000
    0.0326
   -0.0007
   -0.0075
   -0.0000
   -0.0001
   -0.0000
    0.0335
   -0.0012
   -0.0121
   -0.0000
   -0.0001
   -0.0000
    0.0351
   -0.0017
   -0.0197
   -0.0000
   -0.0001
   -0.0000
    0.0376
   -0.0021
   -0.0325
   -0.0001
    0.0001
   -0.0000
    0.0332
    0.0470
    0.0245
    0.0001
    0.0001
   -0.0000
    0.0313
    0.0432
    0.0134
    0.0001
    0.0000
   -0.0000
    0.0303
    0.0409
    0.0068
    0.0000
    0.0000
   -0.0000
    0.0298
    0.0397
    0.0028
   -0.0000
    0.0000
   -0.0000
    0.0296
    0.0390
    0.0001
   -0.0000
   -0.0000
   -0.0000
    0.0297
    0.0387
   -0.0022
   -0.0000
   -0.0000
   -0.0000
    0.0300
    0.0387
   -0.0046
   -0.0000
   -0.0001
   -0.0000
    0.0306
    0.0390
   -0.0076
   -0.0000
   -0.0001
   -0.0001
    0.0315
    0.0398
   -0.0119
   -0.0001
   -0.0001
   -0.0001
    0.0330
    0.0415
   -0.0189
   -0.0001
   -0.0001
   -0.0001
    0.0354
    0.0451
   -0.0305
   -0.0003
    0.0001
   -0.0000
    0.0266
    0.0830
    0.0173
    0.0002
    0.0001
   -0.0000
    0.0253
    0.0765
    0.0093
    0.0001
    0.0000
   -0.0000
    0.0245
    0.0729
    0.0046
    0.0000
    0.0000
   -0.0000
    0.0242
    0.0711
    0.0016
   -0.0000
    0.0000
   -0.0000
    0.0241
    0.0703
   -0.0005
   -0.0000
   -0.0000
   -0.0000
    0.0242
    0.0701
   -0.0024
   -0.0000
   -0.0000
   -0.0000
    0.0245
    0.0704
   -0.0043
   -0.0000
   -0.0001
   -0.0000
    0.0250
    0.0714
   -0.0068
   -0.0001
   -0.0001
   -0.0000
    0.0258
    0.0733
   -0.0102
   -0.0001
   -0.0001
   -0.0000
    0.0270
    0.0769
   -0.0153
   -0.0002
   -0.0001
   -0.0001
    0.0289
    0.0837
   -0.0237
   -0.0004
    0.0001
    0.0001
    0.0172
    0.1031
    0.0073
    0.0001
    0.0001
    0.0001
    0.0166
    0.0952
    0.0039
    0.0001
    0.0000
    0.0001
    0.0163
    0.0911
    0.0018
   -0.0000
    0.0000
    0.0001
    0.0161
    0.0891
    0.0002
   -0.0000
    0.0000
    0.0001
    0.0161
    0.0882
   -0.0010
   -0.0000
   -0.0000
    0.0001
    0.0162
    0.0882
   -0.0023
   -0.0000
   -0.0000
    0.0001
    0.0165
    0.0888
   -0.0036
   -0.0000
   -0.0001
    0.0001
    0.0168
    0.0902
   -0.0052
   -0.0001
   -0.0001
    0.0001
    0.0174
    0.0928
   -0.0071
   -0.0001
   -0.0001
    0.0001
    0.0182
    0.0976
   -0.0097
   -0.0002
   -0.0001
    0.0001
    0.0192
    0.1063
   -0.0133
   -0.0003
    0.0001
    0.0004
    0.0068
    0.1037
   -0.0034
   -0.0001
    0.0001
    0.0003
    0.0069
    0.0960
   -0.0017
   -0.0001
    0.0000
    0.0003
    0.0070
    0.0921
   -0.0011
   -0.0001
    0.0000
    0.0003
    0.0070
    0.0903
   -0.0010
   -0.0001
    0.0000
    0.0003
    0.0071
    0.0897
   -0.0014
   -0.0001
   -0.0000
    0.0003
    0.0072
    0.0898
   -0.0019
   -0.0000
   -0.0000
    0.0003
    0.0074
    0.0906
   -0.0026
   -0.0000
   -0.0000
    0.0003
    0.0076
    0.0921
   -0.0032
   -0.0000
   -0.0001
    0.0003
    0.0079
    0.0949
   -0.0035
   -0.0000
   -0.0001
    0.0003
    0.0082
    0.0999
   -0.0032
   -0.0000
   -0.0001
    0.0003
    0.0083
    0.1087
   -0.0015
    0.0000
    0.0001
    0.0007
   -0.0028
    0.0849
   -0.0126
   -0.0005
    0.0000
    0.0006
   -0.0019
    0.0790
   -0.0064
   -0.0003
    0.0000
    0.0006
   -0.0015
    0.0762
   -0.0033
   -0.0002
    0.0000
    0.0006
   -0.0013
    0.0749
   -0.0019
   -0.0001
    0.0000
    0.0006
   -0.0012
    0.0745
   -0.0014
   -0.0001
   -0.0000
    0.0006
   -0.0011
    0.0747
   -0.0014
   -0.0000
   -0.0000
    0.0006
   -0.0010
    0.0755
   -0.0014
    0.0000
   -0.0000
    0.0006
   -0.0009
    0.0770
   -0.0011
    0.0000
   -0.0001
    0.0006
   -0.0009
    0.0794
    0.0001
    0.0001
   -0.0001
    0.0006
   -0.0011
    0.0837
    0.0030
    0.0002
   -0.0001
    0.0006
   -0.0017
    0.0909
    0.0094
    0.0005
    0.0001
    0.0009
   -0.0097
    0.0508
   -0.0186
   -0.0009
    0.0000
    0.0009
   -0.0084
    0.0479
   -0.0093
   -0.0005
    0.0000
    0.0008
   -0.0077
    0.0466
   -0.0045
   -0.0003
    0.0000
    0.0008
   -0.0074
    0.0462
   -0.0022
   -0.0001
    0.0000
    0.0008
   -0.0073
    0.0461
   -0.0012
   -0.0001
   -0.0000
    0.0008
   -0.0072
    0.0464
   -0.0007
   -0.0000
   -0.0000
    0.0008
   -0.0072
    0.0470
   -0.0003
    0.0000
   -0.0000
    0.0008
   -0.0072
    0.0481
    0.0007
    0.0001
   -0.0000
    0.0008
   -0.0074
    0.0497
    0.0029
    0.0002
   -0.0001
    0.0009
   -0.0079
    0.0524
    0.0076
    0.0005
   -0.0001
    0.0009
   -0.0092
    0.0566
    0.0172
    0.0010
    0.0001
    0.0011
   -0.0127
    0.0087
   -0.0199
   -0.0012
    0.0000
    0.0010
   -0.0113
    0.0094
   -0.0097
   -0.0006
    0.0000
    0.0009
   -0.0106
    0.0100
   -0.0045
   -0.0003
    0.0000
    0.0009
   -0.0103
    0.0103
   -0.0020
   -0.0001
    0.0000
    0.0009
   -0.0102
    0.0105
   -0.0008
   -0.0001
   -0.0000
    0.0009
   -0.0101
    0.0108
   -0.0001
    0.0000
   -0.0000
    0.0009
   -0.0101
    0.0112
    0.0006
    0.0001
   -0.0000
    0.0009
   -0.0102
    0.0116
    0.0018
    0.0002
   -0.0000
    0.0009
   -0.0105
    0.0123
    0.0044
    0.0003
   -0.0001
    0.0010
   -0.0112
    0.0129
    0.0098
    0.0007
   -0.0001
    0.0011
   -0.0127
    0.0133
    0.0204
    0.0013
    0.0000
    0.0010
   -0.0116
   -0.0321
   -0.0163
   -0.0011
    0.0000
    0.0009
   -0.0104
   -0.0280
   -0.0076
   -0.0006
    0.0000
    0.0008
   -0.0098
   -0.0258
   -0.0034
   -0.0003
    0.0000
    0.0008
   -0.0095
   -0.0248
   -0.0014
   -0.0001
    0.0000
    0.0008
   -0.0094
   -0.0244
   -0.0004
   -0.0000
   -0.0000
    0.0008
   -0.0094
   -0.0242
    0.0003
    0.0000
   -0.0000
    0.0008
   -0.0094
   -0.0241
    0.0010
    0.0001
   -0.0000
    0.0008
   -0.0096
   -0.0243
    0.0021
    0.0002
   -0.0000
    0.0008
   -0.0099
   -0.0248
    0.0045
    0.0004
   -0.0000
    0.0009
   -0.0105
   -0.0262
    0.0092
    0.0007
   -0.0001
    0.0010
   -0.0118
   -0.0296
    0.0184
    0.0014
    0.0000
    0.0006
   -0.0068
   -0.0617
   -0.0085
   -0.0010
    0.0000
    0.0005
   -0.0061
   -0.0552
   -0.0036
   -0.0004
    0.0000
    0.0005
   -0.0058
   -0.0523
   -0.0015
   -0.0002
    0.0000
    0.0005
   -0.0057
   -0.0510
   -0.0004
   -0.0001
    0.0000
    0.0005
   -0.0056
   -0.0504
    0.0001
    0.0000
   -0.0000
    0.0005
   -0.0056
   -0.0503
    0.0005
    0.0001
   -0.0000
    0.0005
   -0.0056
   -0.0505
    0.0009
    0.0001
   -0.0000
    0.0005
   -0.0057
   -0.0511
    0.0017
    0.0002
   -0.0000
    0.0005
   -0.0059
   -0.0526
    0.0032
    0.0003
   -0.0000
    0.0005
   -0.0063
   -0.0557
    0.0061
    0.0005
   -0.0000
    0.0006
   -0.0071
   -0.0621
    0.0117
    0.0012
   -0.0708
    0.0008
    0.0011
   -0.0653
    0.0011
    0.0002
   -0.0623
    0.0005
    0.0000
   -0.0608
    0.0006
    0.0001
   -0.0602
    0.0005
    0.0001
   -0.0601
    0.0006
    0.0001
   -0.0603
    0.0006
    0.0001
   -0.0611
    0.0006
    0.0001
   -0.0631
    0.0007
    0.0002
   -0.0671
    0.0006
    0.0001
   -0.0766
    0.0016
   -0.0004

Eigenfrequency
  298.7812
```

![figure_7.png
](README_images/figure_7.png
)

![figure_8.png
](README_images/figure_8.png
)

![figure_9.png
](README_images/figure_9.png
)

![figure_10.png
](README_images/figure_10.png
)

```text:Output
Displacement at output DOF: 0.0031676
```

Pick up two initial trajectories that has high expected nonlinear content

```matlab:Code
indIC2 = [nsteps, nsteps-1];
IC2 = [phi2*(scalingfactor2*indIC2/nsteps);zeros(n,length(indIC2))];
```

Pick combination of initial conditions along the both the modes for training and testing

```matlab:Code
a = rand; b = rand; 
ICs = [IC1, IC2, a*IC1 + b*IC2];
indTrain = [1 3 5 6];
indTest = [2 4];
```

Define the linear regime at 1 % relative force

```matlab:Code
linearDisplacementReference = scalingfactor1*(sum(relativeDiffForceNorm<1)+1)/nsteps;
nonlinearDisplacementReference = scalingfactor1*max(indIC1)/nsteps;
desiredAmplitudeDecay = nonlinearDisplacementReference/linearDisplacementReference;

```

# **Generate decaying trajectories via time integration**

Define observables and timescales

```matlab:Code
observable = @(x) x; % Observe the full phase space
slowTimeScale = 2*pi/abs(lambda(1));
fastTimeScale = 2*pi/abs(lambda(2));
```

Integrate

```matlab:Code
newSimulation = false;
if newSimulation
    numberPeriodsSlow = floor(log(desiredAmplitudeDecay)/...
        (2*pi*(-real(lambda(1))/abs(lambda(1)))))
    endTime = numberPeriodsSlow*slowTimeScale;
```

Set the sampling time to capture approximately 50 points per period on the faster time scale

```matlab:Code
    numberPeriodsFast = floor(endTime/fastTimeScale);
    numberPointsPerPeriod = 50;
    nSamp = numberPeriodsFast*numberPointsPerPeriod+1;
    dt = endTime/(nSamp-1);
    xData = integrateTrajectoriesGalphaDirect(Model, endTime, ICs, nSamp, observable);
    % xData = integrateTrajectoriesNewmarkDirect(Model, DS, endTime, IC, nSamp, observable);
    loadShape = f_0;
    DataInfo = struct('nElements', Model.Mesh.nElements, 'loadShape', loadShape);
    save('dataVKDecay2DGalphaModal.mat', 'DataInfo', 'xData', 'dt', 'endTime', 'nSamp','-v7.3')
else
    load("../../data/vonkarmanshellIR/dataVKDecay2DGalphaModal.mat")
end

```

# Visualize data

```matlab:Code
yData = coordinatesEmbedding(xData, SSMDim, 'ForceEmbedding', 1);
```

```text:Output
The embedding coordinates consist of the measured states.
```

Data filtering: We need to make sure that the data that we use to identify the slow manifold lies close to it. We can do this by plotting a spectrogram of the beam tip displacement. In general, there may be many vibratory modes present at first, but the faster ones quickly die out.

```matlab:Code
indPlot1 = indTrain(1);
indPlot2 = indTest(1);

showSpectrogram(yData(indPlot1,:), outdof(1));
ylim([0,abs(lambda(1))/2/pi*5])
```

![figure_11.png
](README_images/figure_11.png
)

```matlab:Code
showSpectrogram(yData(indPlot2,:), outdof(1));
ylim([0,abs(lambda(1))/2/pi*5])
```

![figure_12.png
](README_images/figure_12.png
)

We plot the tip displacement over time for closer inspection. 

```matlab:Code
fig = customFigure();
for iTraj = indTrain
    if iTraj == indTrain(1)
        plot(xData{iTraj,1}, xData{iTraj,2}(outdof(1),:),'DisplayName','Training data');
    else
        plot(xData{iTraj,1}, xData{iTraj,2}(outdof(1),:),'HandleVisibility','off');
    end
end
for iTraj = indTest
    if iTraj == indTest(1)
        plot(xData{iTraj,1}, xData{iTraj,2}(outdof(1),:),':','DisplayName','Test data');
    else
        plot(xData{iTraj,1}, xData{iTraj,2}(outdof(1),:),':','HandleVisibility','off');
    end
end
legend('location','NE')
xlabel('$t \, [$s$]$','Interpreter','latex'); ylabel('$q_{\mathrm{out}} \, [$m$]$','Interpreter','latex'); 
title('Generated data')
```

![figure_13.png
](README_images/figure_13.png
)

# Truncate transient data from trajectories

Next, we use the information from the spectrogram and plot to remove the first part of the training data. After the first few oscillations have passed, there is one dominant mode left in the frequency spectrum. In this case, faster modes die out very quickly, so we can use almost all of the data. We must however remove the first transient to fulfill the assumption that trajectories lie close to the SSM. We keep only the time interval |sliceInt|.

```matlab:Code
sliceInt = [5*slowTimeScale, endTime];
yDataTrunc = sliceTrajectories(yData, sliceInt);
```

# Datadriven manifold fitting

The measured trajectories are assumed to lie close to a two-dimensional manifold that is tangent at the origin to the eigenspace corresponding to the slowest pair of eigenvalues. We now fit a polynomial of order $M$ to the data points to approximate the manifold. Here we use a graph style parametrization, meaning that the manifold is parametrized using coordinates $\eta =W_e y$ of the eigenspace represenation $V_e$. This excludes the possibility of folds on the manifold (however, if necessary we may circumvent this problem by increasing the dimensionality of the observed space). 

We seek the $2n\times m_M$ polynomial coefficient matrix $H$ of the manifold on the form

$y=V_e V_e^{\top } y+H\phi_{m,2:M} (V_e^{\top } y)$,

where the function $\phi_{m,2:M} (q)$ computes a vector of all $m_M$ monomials from orders 2 up to $M$ of an $m$-vector $q$. The coefficients $H$are obtained via regression.

```matlab:Code
SSMOrder = 2;

% Get projection or modal coordinates 
SSMDim = size(Ve,2);
etaDataTrunc = yDataTrunc;
nTraj = size(yDataTrunc,1);
for iTraj = 1:nTraj
    etaDataTrunc{iTraj,2} = We*yDataTrunc{iTraj,2};    
end

% Plot reduced coordinates
plotReducedCoordinates(etaDataTrunc);
if SSMDim>2
   view(3) 
end
```

![figure_14.png
](README_images/figure_14.png
)

```matlab:Code

% Compute nonlinear part of the parametrization
IMInfo = IMGeometry(yDataTrunc(indTrain,:), SSMDim,SSMOrder,...
         'reducedCoordinates',etaDataTrunc(indTrain,:),'Ve',Ve,'outdof',outdof); 
IMInfo.chart.map = @(x) We*x;                          

% Parametrization error on test trajectory
normedTrajDist = computeTrajectoryErrors(liftTrajectories(IMInfo,...
    etaDataTrunc), yDataTrunc);
staticNMTE = mean(normedTrajDist(indTest))*100; % in percentage

disp(['Reconstruction error = ' num2str(staticNMTE) '%'])
```

```text:Output
Reconstruction error = 0.94102%
```

```matlab:Code
% Visualize the trajectories in different coordinates
fig = customFigure();
for iTraj = indTrain
    plot3(xData{iTraj,2}(outdof(1),:),xData{iTraj,2}(outdof(1)+size(M,1),:),xData{iTraj,2}(outdof(2),:))
end
xlabel('$q_{A}$ [m]','interpreter','latex')
ylabel('$\dot{q}_{A}$ [m/s]','interpreter','latex')
zlabel('$q_{B}$ [m]','interpreter','latex')
legend('Trajectory 1','Trajectory 2','Trajectory 3')
view(3)
```

![figure_15.png
](README_images/figure_15.png
)

```matlab:Code

fig = customFigure('subPlot',[3 2]);
for iTraj = [1 3 5]
    subplot(3,2,iTraj)
    plot(xData{iTraj,1}, xData{iTraj,2}(outdof(1),:));
    xlabel('$t \, [$s$]$','Interpreter','latex'); 
    ylabel('$q_{out,1} \, [$m$]$','Interpreter','latex'); 
    subplot(3,2,iTraj+1)
    plot(xData{iTraj,1}, xData{iTraj,2}(outdof(2),:));
    xlabel('$t \, [$s$]$','Interpreter','latex'); 
    ylabel('$q_{out,2} \, [$m$]$','Interpreter','latex'); 
end
```

![figure_16.png
](README_images/figure_16.png
)

```matlab:Code

```

```matlab:Code
% Visualize spectrograms for the first outdof
fig = customFigure();
fontName = 'helvetica';
fontSize = 16;
tiledlayout(3,1);
nexttile
```

![figure_17.png
](README_images/figure_17.png
)

```matlab:Code
showSpectrogram(yData(1,:), outdof(1), 1);
ylim([0,70])%abs(lambda(1))/2/pi*5])
set(gca, 'fontname', fontName)
set(gca, 'fontsize', fontSize)
xticks([])
nexttile
```

![figure_18.png
](README_images/figure_18.png
)

![figure_19.png
](README_images/figure_19.png
)

```matlab:Code
showSpectrogram(yData(3,:), outdof(1), 1);
ylim([0,70])%abs(lambda(1))/2/pi*5])
set(gca, 'fontname', fontName)
set(gca, 'fontsize', fontSize)
ylabel('frequency [Hz]')
xticks([])
nexttile
```

![figure_20.png
](README_images/figure_20.png
)

![figure_21.png
](README_images/figure_21.png
)

```matlab:Code
showSpectrogram(yData(5,:), outdof(1), 1);
ylim([0,70])%abs(lambda(1))/2/pi*5])
xlabel('time [s]')
cb = colorbar;
%cb.Layout.Tile = 'east';
cb.Label.String = 'power spectral density [1/Hz]';
set(gca, 'fontname', fontName)
set(gca, 'fontsize', fontSize)
```

![figure_22.png
](README_images/figure_22.png
)

# Reduced dynamics on the manifold

We compute a model for the reduced dynamics with the truncated training data projected onto the manifold. The function `IMDynamicsFlow` fits a polynomial map = 

$$
\dot{\eta} =W_r \phi (\eta )
$$

where $\phi (\eta )$ again computes a vector of all monomials of $\eta$, and  $W_r$ is a matrix of polynomial coefficients. 

We are also specifying that we want the reduced dynamics on a normal form, and seek the Taylor expansion of a map $N$ fulfilling

$$
\dot{z} =N(z)=Dz+W_n \phi (z)
$$

with $D$ a diagonal matrix and $W_n$ containing coefficients for the near-resonant nonlinear terms, after a near-identity change of coordinates

$$
z=T^{-1} (\eta )=\eta +W_t \phi (\eta )
$$

with $W_t$ containing the coefficients for the nonlinear terms of the coordinate change. Here we fix the linear part.

```matlab:Code
ROMOrder = 3;
freqNorm = [1 2];

RDInfo = IMDynamicsMech(etaDataTrunc(indTrain,:), ...
    'R_PolyOrd', 1,'N_PolyOrd', ROMOrder, 'style', 'normalform', ...
    'R_coeff',Ae,'rescale',1,'frequencies_norm',freqNorm,'MaxIter',5e3);
```

```text:Output
Estimation of the reduced dynamics...  Done. 
Estimation of the reduced dynamics in normal form...
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
     0           1          6.16336                          29.1
     1           3           4.2627     0.00343599           27.1  
     2           4          3.00363              1           13.9  
     3           5         0.876018              1           7.36  
     4           6          0.67696              1           3.61  
     5           7         0.630143              1           1.83  
     6           8         0.587024              1            2.2  
     7           9         0.504308              1           4.57  
     8          10         0.434066              1           4.08  
     9          11         0.389986              1           1.81  
    10          12         0.365842              1           1.43  
    11          13         0.343188              1           2.02  
    12          14         0.320993              1           2.21  
    13          15         0.303823              1           1.35  
    14          16          0.29072              1           1.54  
    15          17         0.277463              1           1.43  
    16          18         0.264651              1           1.75  
    17          19         0.256796              1              1  
    18          20         0.253417              1          0.462  
    19          21         0.251195              1          0.499  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
    20          22         0.248591              1          0.858  
    21          23         0.246484              1          0.689  
    22          24         0.245526              1          0.223  
    23          25         0.245121              1          0.189  
    24          26         0.244644              1          0.365  
    25          27         0.243799              1          0.603  
    26          28         0.242742              1          0.608  
    27          29         0.241905              1          0.312  
    28          30         0.241405              1          0.245  
    29          31         0.240924              1           0.32  
    30          32         0.240127              1          0.595  
    31          33         0.239032              1          0.687  
    32          34         0.238147              1          0.438  
    33          35           0.2378              1         0.0993  
    34          36         0.237683              1         0.0716  
    35          37         0.237553              1          0.193  
    36          38         0.237276              1          0.325  
    37          39          0.23678              1          0.405  
    38          40         0.236037              1          0.366  
    39          41         0.235213              1          0.404  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
    40          42          0.23452              1          0.297  
    41          43          0.23403              1           0.25  
    42          44         0.233694              1          0.205  
    43          45         0.233436              1          0.167  
    44          46         0.233179              1          0.203  
    45          47         0.232854              1          0.262  
    46          48         0.232495              1          0.302  
    47          49         0.232249              1           0.18  
    48          50         0.232146              1         0.0709  
    49          51          0.23209              1         0.0667  
    50          52         0.232005              1          0.155  
    51          53         0.231863              1          0.218  
    52          54         0.231685              1          0.196  
    53          55         0.231539              1         0.0843  
    54          56         0.231439              1          0.076  
    55          57         0.231339              1          0.132  
    56          58         0.231202              1          0.189  
    57          59         0.231046              1           0.16  
    58          60         0.230916              1          0.102  
    59          61         0.230814              1          0.102  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
    60          62         0.230707              1          0.139  
    61          63         0.230591              1           0.16  
    62          64         0.230509              1         0.0944  
    63          65         0.230474              1         0.0445  
    64          66         0.230453              1           0.04  
    65          67         0.230421              1         0.0885  
    66          68         0.230371              1           0.12  
    67          69         0.230321              1         0.0955  
    68          70         0.230299              1         0.0345  
    69          71         0.230293              1         0.0118  
    70          72          0.23029              1         0.0172  
    71          73         0.230283              1         0.0388  
    72          74         0.230269              1         0.0607  
    73          75         0.230247              1         0.0697  
    74          76         0.230225              1         0.0481  
    75          77         0.230212              1         0.0268  
    76          78         0.230204              1         0.0265  
    77          79         0.230193              1         0.0449  
    78          80         0.230169              1         0.0777  
    79          81         0.230126              1          0.101  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
    80          82         0.230078              1         0.0854  
    81          83          0.23005              1         0.0355  
    82          84         0.230043              1          0.011  
    83          85          0.23004              1         0.0126  
    84          86         0.230034              1         0.0273  
    85          87         0.230023              1         0.0417  
    86          88         0.230005              1         0.0458  
    87          89         0.229988              1         0.0297  
    88          90         0.229975              1         0.0299  
    89          91         0.229964              1         0.0279  
    90          92         0.229947              1         0.0445  
    91          93         0.229917              1         0.0663  
    92          94         0.229875              1         0.0672  
    93          95         0.229842              1         0.0373  
    94          96         0.229827              1         0.0245  
    95          97         0.229817              1         0.0197  
    96          98         0.229803              1         0.0377  
    97          99         0.229779              1         0.0509  
    98         100         0.229753              1         0.0423  
    99         101         0.229738              1         0.0162  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   100         102         0.229731              1         0.0133  
   101         103         0.229724              1         0.0192  
   102         104          0.22971              1         0.0398  
   103         105          0.22968              1         0.0622  
   104         106         0.229631              1         0.0722  
   105         107         0.229586              1         0.0508  
   106         108         0.229567              1         0.0159  
   107         109         0.229564              1         0.0128  
   108         110         0.229562              1         0.0121  
   109         111         0.229558              1         0.0145  
   110         112          0.22955              1         0.0227  
   111         113         0.229538              1         0.0261  
   112         114         0.229527              1         0.0179  
   113         115         0.229522              1         0.0115  
   114         116          0.22952              1         0.0109  
   115         117         0.229519              1        0.00971  
   116         118         0.229516              1         0.0123  
   117         119         0.229509              1         0.0194  
   118         120         0.229496              1          0.024  
   119         121         0.229483              1         0.0193  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   120         122         0.229475              1        0.00888  
   121         123         0.229473              1         0.0091  
   122         124         0.229471              1        0.00917  
   123         125         0.229468              1        0.00948  
   124         126         0.229463              1         0.0124  
   125         127         0.229456              1         0.0176  
   126         128         0.229451              1         0.0226  
   127         129         0.229447              1         0.0214  
   128         130         0.229444              1         0.0162  
   129         131         0.229438              1         0.0125  
   130         132         0.229431              1         0.0148  
   131         133         0.229424              1         0.0195  
   132         134         0.229418              1         0.0246  
   133         135         0.229411              1         0.0259  
   134         136         0.229398              1         0.0251  
   135         137         0.229371              1         0.0361  
   136         138          0.22933              1         0.0625  
   137         139         0.229282              1         0.0742  
   138         140         0.229246              1         0.0578  
   139         141         0.229228              1         0.0282  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   140         142         0.229219              1         0.0094  
   141         143         0.229214              1         0.0101  
   142         144         0.229212              1         0.0127  
   143         145         0.229208              1         0.0108  
   144         146         0.229201              1         0.0144  
   145         147         0.229185              1         0.0222  
   146         148         0.229153              1          0.032  
   147         149         0.229099              1         0.0539  
   148         150         0.229038              1         0.0645  
   149         151         0.228994              1         0.0497  
   150         152          0.22897              1         0.0285  
   151         153         0.228956              1         0.0166  
   152         154         0.228946              1         0.0164  
   153         155         0.228939              1         0.0192  
   154         156         0.228931              1         0.0177  
   155         157         0.228918              1         0.0242  
   156         158         0.228892              1         0.0347  
   157         159         0.228848              1         0.0454  
   158         160         0.228789              1         0.0611  
   159         161         0.228725              1         0.0692  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   160         162         0.228664              1         0.0618  
   161         163         0.228613              1         0.0418  
   162         164          0.22858              1         0.0202  
   163         165         0.228566              1         0.0165  
   164         166          0.22856              1         0.0147  
   165         167         0.228553              1         0.0091  
   166         168         0.228544              1         0.0108  
   167         169         0.228533              1         0.0188  
   168         170          0.22852              1         0.0299  
   169         171         0.228505              1         0.0387  
   170         172         0.228478              1         0.0452  
   171         173         0.228424              1         0.0465  
   172         174         0.228332              1          0.045  
   173         175         0.228226              1         0.0559  
   174         176         0.228157              1         0.0555  
   175         177         0.228125              1         0.0475  
   176         178         0.228099              1         0.0359  
   177         179         0.228065              1         0.0262  
   178         180         0.228034              1         0.0163  
   179         181         0.228019              1         0.0119  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   180         182         0.228014              1         0.0116  
   181         183          0.22801              1         0.0119  
   182         184         0.227998              1         0.0134  
   183         185         0.227972              1         0.0241  
   184         186         0.227916              1         0.0364  
   185         187         0.227825              1         0.0419  
   186         188         0.227737              1         0.0297  
   187         189         0.227697              1         0.0178  
   188         190         0.227687              1          0.018  
   189         191         0.227681              1         0.0174  
   190         192         0.227667              1         0.0161  
   191         193          0.22764              1         0.0187  
   192         194         0.227598              1         0.0297  
   193         195         0.227559              1          0.039  
   194         196         0.227534              1          0.045  
   195         197         0.227514              1         0.0441  
   196         198          0.22748              1         0.0392  
   197         199         0.227414              1         0.0293  
   198         200         0.227314              1         0.0339  
   199         201         0.227225              1          0.043  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   200         202         0.227185              1          0.034  
   201         203         0.227172              1         0.0302  
   202         204         0.227159              1         0.0258  
   203         205         0.227135              1         0.0142  
   204         206         0.227103              1         0.0217  
   205         207         0.227077              1         0.0274  
   206         208         0.227063              1          0.025  
   207         209         0.227051              1         0.0251  
   208         210         0.227027              1         0.0262  
   209         211         0.226973              1         0.0265  
   210         212         0.226862              1         0.0403  
   211         213          0.22669              1          0.057  
   212         214         0.226531              1         0.0501  
   213         215         0.226452              1         0.0564  
   214         216         0.226416              1          0.055  
   215         217          0.22637              1         0.0506  
   216         218         0.226281              1         0.0414  
   217         219         0.226156              1         0.0425  
   218         220         0.226057              1         0.0298  
   219         221          0.22602              1         0.0224  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   220         222         0.226009              1         0.0191  
   221         223         0.225997              1         0.0177  
   222         224         0.225968              1         0.0212  
   223         225         0.225917              1         0.0304  
   224         226         0.225852              1         0.0288  
   225         227         0.225806              1         0.0352  
   226         228         0.225784              1         0.0432  
   227         229         0.225766              1         0.0459  
   228         230         0.225726              1         0.0479  
   229         231         0.225634              1         0.0496  
   230         232         0.225437              1         0.0652  
   231         233         0.225108              1         0.0932  
   232         234         0.224743              1          0.127  
   233         235         0.224492              1          0.128  
   234         236         0.224335              1          0.116  
   235         237          0.22416              1         0.0878  
   236         238         0.223906              1         0.0741  
   237         239         0.223663              1         0.0515  
   238         240         0.223545              1         0.0469  
   239         241         0.223509              1          0.036  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   240         242         0.223484              1         0.0348  
   241         243         0.223433              1         0.0317  
   242         244         0.223361              1         0.0254  
   243         245         0.223294              1         0.0295  
   244         246          0.22326              1         0.0293  
   245         247         0.223241              1         0.0355  
   246         248          0.22321              1         0.0412  
   247         249         0.223139              1          0.047  
   248         250         0.222982              1         0.0501  
   249         251         0.222704              1         0.0711  
   250         252         0.222385              1         0.0814  
   251         253         0.222191              1          0.101  
   252         254         0.222117              1          0.102  
   253         255         0.222058              1         0.0976  
   254         256         0.221928              1         0.0875  
   255         257         0.221649              1         0.0749  
   256         258         0.221144              1         0.0981  
   257         259         0.220559              1         0.0832  
   258         260         0.220215              1         0.0613  
   259         261          0.22011              1         0.0576  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   260         262         0.220059              1         0.0527  
   261         263         0.219965              1         0.0423  
   262         264         0.219803              1         0.0468  
   263         265         0.219613              1         0.0401  
   264         266         0.219502              1         0.0398  
   265         267         0.219467              1          0.036  
   266         268         0.219447              1         0.0296  
   267         269         0.219405              1         0.0249  
   268         270         0.219311              1         0.0356  
   269         271         0.219116              1           0.05  
   270         272         0.218823              1         0.0925  
   271         273         0.218546              1          0.121  
   272         274         0.218384              1          0.116  
   273         275         0.218272              1         0.0974  
   274         276          0.21809              1         0.0867  
   275         277         0.217717              1         0.0897  
   276         278         0.217102              1         0.0827  
   277         279         0.216477              1         0.0755  
   278         280         0.216172              1         0.0689  
   279         281         0.216088              1         0.0723  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   280         282         0.216034              1           0.07  
   281         283          0.21591              1         0.0603  
   282         284         0.215671              1         0.0452  
   283         285         0.215306              1          0.069  
   284         286         0.214995              1         0.0571  
   285         287         0.214862              1         0.0669  
   286         288         0.214812              1         0.0659  
   287         289         0.214746              1         0.0614  
   288         290         0.214577              1         0.0521  
   289         291          0.21416              1         0.0947  
   290         292         0.213157              1          0.161  
   291         293         0.211074              1          0.232  
   292         294         0.207866              1           0.25  
   293         295         0.205093              1          0.162  
   294         296         0.204073              1          0.105  
   295         297         0.203904              1          0.104  
   296         298          0.20384              1          0.102  
   297         299         0.203664              1          0.096  
   298         300         0.203255              1         0.0862  
   299         301         0.202245              1           0.11  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   300         302         0.200155              1          0.155  
   301         303         0.196897              1          0.167  
   302         304         0.194052              1          0.108  
   303         305         0.192989              1          0.091  
   304         306         0.192821              1          0.085  
   305         307         0.192771              1         0.0808  
   306         308         0.192644              1         0.0713  
   307         309         0.192368              1         0.0528  
   308         310         0.191802              1         0.0447  
   309         311         0.191014              1          0.045  
   310         312         0.190415              1         0.0599  
   311         313         0.190218              1         0.0597  
   312         314         0.190172              1         0.0523  
   313         315         0.190126              1         0.0453  
   314         316         0.189996              1          0.032  
   315         317         0.189681              1         0.0367  
   316         318         0.188889              1         0.0463  
   317         319          0.18713              1         0.0684  
   318         320         0.183956              1          0.109  
   319         321         0.180318              1          0.112  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   320         322         0.178341              1         0.0741  
   321         323         0.177916              1         0.0708  
   322         324         0.177839              1          0.068  
   323         325          0.17774              1         0.0652  
   324         326         0.177462              1         0.0598  
   325         327         0.176802              1         0.0507  
   326         328         0.175275              1         0.0717  
   327         329         0.172442              1          0.106  
   328         330         0.168943              1          0.111  
   329         331         0.166818              1          0.122  
   330         332         0.166277              1           0.11  
   331         333         0.166158              1          0.101  
   332         334         0.166009              1         0.0905  
   333         335          0.16562              1         0.0689  
   334         336         0.164818              1         0.0413  
   335         337         0.163483              1         0.0445  
   336         338         0.162202              1         0.0568  
   337         339         0.161653              1         0.0563  
   338         340         0.161554              1         0.0433  
   339         341         0.161524              1         0.0382  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   340         342         0.161457              1         0.0379  
   341         343         0.161296              1         0.0373  
   342         344         0.160912              1         0.0359  
   343         345         0.160145              1         0.0528  
   344         346         0.159048              1         0.0791  
   345         347         0.158207              1         0.0714  
   346         348          0.15793              1         0.0452  
   347         349         0.157873              1          0.044  
   348         350         0.157828              1         0.0439  
   349         351         0.157697              1         0.0429  
   350         352         0.157402              1           0.04  
   351         353         0.156751              1         0.0474  
   352         354         0.155689              1         0.0733  
   353         355         0.154645              1         0.0685  
   354         356         0.154188              1         0.0404  
   355         357         0.154101              1         0.0395  
   356         358         0.154072              1         0.0374  
   357         359         0.154005              1         0.0339  
   358         360         0.153853              1         0.0326  
   359         361         0.153516              1         0.0312  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   360         362         0.152961              1          0.044  
   361         363         0.152412              1         0.0363  
   362         364         0.152174              1          0.023  
   363         365         0.152135              1         0.0249  
   364         366         0.152128              1         0.0246  
   365         367         0.152117              1         0.0238  
   366         368         0.152088              1         0.0215  
   367         369         0.152023              1         0.0163  
   368         370         0.151891              1         0.0183  
   369         371         0.151709              1         0.0197  
   370         372         0.151574              1         0.0223  
   371         373         0.151531              1          0.024  
   372         374         0.151522              1         0.0222  
   373         375         0.151513              1         0.0205  
   374         376         0.151489              1         0.0172  
   375         377         0.151431              1         0.0122  
   376         378         0.151283              1         0.0178  
   377         379         0.150956              1         0.0291  
   378         380         0.150364              1         0.0467  
   379         381         0.149682              1         0.0521  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   380         382         0.149306              1         0.0414  
   381         383          0.14922              1          0.042  
   382         384           0.1492              1         0.0403  
   383         385          0.14917              1         0.0377  
   384         386         0.149094              1          0.032  
   385         387         0.148925              1         0.0231  
   386         388         0.148617              1         0.0195  
   387         389         0.148258              1         0.0266  
   388         390         0.148058              1         0.0238  
   389         391         0.148012              1         0.0205  
   390         392         0.148001              1         0.0177  
   391         393         0.147986              1         0.0176  
   392         394         0.147946              1         0.0175  
   393         395         0.147846              1         0.0167  
   394         396         0.147606              1         0.0238  
   395         397         0.147115              1         0.0376  
   396         398         0.146382              1         0.0425  
   397         399         0.145783              1         0.0282  
   398         400         0.145579              1         0.0233  
   399         401          0.14555              1         0.0234  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   400         402          0.14554              1          0.023  
   401         403         0.145513              1         0.0217  
   402         404         0.145449              1         0.0189  
   403         405         0.145288              1         0.0164  
   404         406         0.144939              1          0.024  
   405         407         0.144333              1         0.0307  
   406         408         0.143689              1         0.0582  
   407         409         0.143366              1         0.0701  
   408         410         0.143291              1         0.0676  
   409         411         0.143262              1         0.0643  
   410         412         0.143196              1         0.0587  
   411         413         0.143033              1         0.0495  
   412         414         0.142609              1          0.034  
   413         415         0.141565              1         0.0383  
   414         416         0.139185              1         0.0586  
   415         417         0.134756              1         0.0748  
   416         418          0.12934              1         0.0973  
   417         419         0.126116              1         0.0743  
   418         420         0.125363              1         0.0662  
   419         421         0.125249              1         0.0653  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   420         422         0.125149              1          0.064  
   421         423         0.124837              1         0.0607  
   422         424         0.124107              1         0.0544  
   423         425         0.122298              1         0.0414  
   424         426          0.11852              1         0.0712  
   425         427          0.11251              1         0.0939  
   426         428         0.107063              1          0.089  
   427         429         0.104947              1          0.101  
   428         430         0.104619              1         0.0944  
   429         431         0.104539              1         0.0904  
   430         432          0.10436              1         0.0834  
   431         433         0.103922              1         0.0712  
   432         434         0.102835              1         0.0517  
   433         435         0.100458              1         0.0492  
   434         436        0.0963495              1         0.0629  
   435         437        0.0920238              1         0.0778  
   436         438        0.0899582              1         0.0743  
   437         439        0.0895892              1         0.0573  
   438         440        0.0895425              1         0.0507  
   439         441         0.089492              1         0.0456  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   440         442        0.0893384              1         0.0412  
   441         443         0.088984              1         0.0408  
   442         444        0.0881602              1         0.0359  
   443         445         0.086662              1         0.0348  
   444         446        0.0848666              1         0.0507  
   445         447        0.0838389              1          0.038  
   446         448        0.0836107              1         0.0314  
   447         449        0.0835783              1         0.0305  
   448         450        0.0835496              1         0.0294  
   449         451        0.0834589              1         0.0278  
   450         452        0.0832431              1         0.0276  
   451         453        0.0826831              1         0.0272  
   452         454        0.0813745              1         0.0461  
   453         455        0.0786994              1         0.0652  
   454         456        0.0747969              1         0.0705  
   455         457         0.071702              1         0.0749  
   456         458        0.0707053              1         0.0617  
   457         459         0.070571              1         0.0533  
   458         460         0.070528              1         0.0503  
   459         461        0.0704045              1         0.0442  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   460         462        0.0701189              1         0.0435  
   461         463        0.0693997              1          0.043  
   462         464        0.0678608              1         0.0431  
   463         465        0.0652674              1         0.0588  
   464         466        0.0626697              1         0.0879  
   465         467        0.0615021              1         0.0841  
   466         468        0.0612844              1         0.0711  
   467         469        0.0612279              1         0.0652  
   468         470        0.0611117              1         0.0567  
   469         471        0.0608209              1          0.051  
   470         472        0.0600991              1         0.0476  
   471         473        0.0584715              1         0.0396  
   472         474        0.0554912              1         0.0499  
   473         475        0.0519784              1         0.0648  
   474         476        0.0500172              1         0.0414  
   475         477        0.0496183              1         0.0179  
   476         478        0.0495876              1         0.0177  
   477         479        0.0495802              1         0.0177  
   478         480        0.0495532              1         0.0176  
   479         481        0.0494939              1         0.0174  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   480         482        0.0493398              1         0.0171  
   481         483        0.0490079              1         0.0176  
   482         484        0.0484275              1         0.0267  
   483         485        0.0478108              1         0.0268  
   484         486        0.0475106              1         0.0181  
   485         487        0.0474545              1         0.0179  
   486         488        0.0474451              1         0.0182  
   487         489        0.0474324              1         0.0183  
   488         490        0.0473966              1         0.0182  
   489         491        0.0473106              1         0.0175  
   490         492        0.0471072              1         0.0153  
   491         493        0.0467106              1         0.0162  
   492         494        0.0461722              1         0.0203  
   493         495        0.0457979              1         0.0193  
   494         496         0.045696              1         0.0181  
   495         497        0.0456844              1         0.0166  
   496         498        0.0456806              1          0.016  
   497         499        0.0456685              1         0.0145  
   498         500        0.0456417              1         0.0119  
   499         501        0.0455766              1        0.00828  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   500         502        0.0454528              1        0.00725  
   501         503        0.0452878              1        0.00931  
   502         504        0.0451775              1         0.0127  
   503         505        0.0451483              1         0.0109  
   504         506        0.0451445              1        0.00932  
   505         507        0.0451425              1        0.00855  
   506         508        0.0451359              1        0.00794  
   507         509        0.0451208              1        0.00791  
   508         510        0.0450824              1        0.00741  
   509         511        0.0450001              1        0.00674  
   510         512        0.0448597              1          0.011  
   511         513        0.0447167              1         0.0115  
   512         514        0.0446519              1        0.00671  
   513         515        0.0446411              1        0.00672  
   514         516        0.0446399              1        0.00645  
   515         517        0.0446386              1        0.00622  
   516         518        0.0446345              1        0.00588  
   517         519        0.0446248              1        0.00584  
   518         520        0.0445996              1        0.00579  
   519         521        0.0445413              1        0.00781  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   520         522        0.0444243              1         0.0107  
   521         523        0.0442602              1         0.0115  
   522         524        0.0441385              1         0.0125  
   523         525        0.0441023              1         0.0131  
   524         526        0.0440975              1         0.0126  
   525         527        0.0440956              1         0.0122  
   526         528        0.0440897              1         0.0114  
   527         529        0.0440762              1         0.0101  
   528         530        0.0440408              1        0.00763  
   529         531          0.04396              1        0.00583  
   530         532        0.0438011              1         0.0072  
   531         533        0.0435878              1         0.0108  
   532         534        0.0434399              1         0.0126  
   533         535        0.0433989              1         0.0121  
   534         536         0.043393              1         0.0122  
   535         537        0.0433895              1         0.0122  
   536         538        0.0433781              1         0.0122  
   537         539        0.0433515              1         0.0121  
   538         540        0.0432803              1         0.0117  
   539         541        0.0431064              1         0.0109  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   540         542        0.0427064              1         0.0142  
   541         543        0.0419558              1         0.0276  
   542         544        0.0410192              1         0.0372  
   543         545        0.0404458              1         0.0348  
   544         546        0.0403098              1         0.0277  
   545         547         0.040292              1          0.029  
   546         548        0.0402799              1         0.0293  
   547         549        0.0402403              1         0.0295  
   548         550        0.0401504              1          0.029  
   549         551        0.0399294              1         0.0266  
   550         552         0.039488              1         0.0199  
   551         553        0.0388436              1         0.0166  
   552         554        0.0383429              1         0.0231  
   553         555        0.0381852              1         0.0211  
   554         556        0.0381657              1         0.0182  
   555         557         0.038161              1          0.018  
   556         558         0.038148              1         0.0179  
   557         559        0.0381173              1         0.0178  
   558         560         0.038037              1         0.0174  
   559         561        0.0378465              1         0.0165  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   560         562        0.0374422              1         0.0218  
   561         563        0.0368044              1         0.0425  
   562         564        0.0362265              1         0.0535  
   563         565         0.036003              1         0.0487  
   564         566         0.035968              1         0.0423  
   565         567        0.0359591              1         0.0398  
   566         568        0.0359384              1         0.0358  
   567         569        0.0358888              1         0.0293  
   568         570        0.0357669              1         0.0181  
   569         571        0.0355096              1         0.0156  
   570         572        0.0350963              1         0.0164  
   571         573        0.0347156              1         0.0222  
   572         574        0.0345672              1         0.0135  
   573         575        0.0345473              1         0.0063  
   574         576        0.0345459              1        0.00625  
   575         577         0.034545              1        0.00624  
   576         578        0.0345414              1        0.00627  
   577         579        0.0345335              1        0.00618  
   578         580        0.0345142              1        0.00563  
   579         581        0.0344771              1        0.00775  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   580         582        0.0344265              1        0.00949  
   581         583        0.0343917              1        0.00648  
   582         584        0.0343823              1        0.00438  
   583         585        0.0343813              1        0.00436  
   584         586         0.034381              1        0.00436  
   585         587        0.0343801              1        0.00435  
   586         588        0.0343781              1        0.00434  
   587         589        0.0343726              1        0.00429  
   588         590        0.0343594              1        0.00418  
   589         591        0.0343297              1        0.00665  
   590         592        0.0342774              1        0.00882  
   591         593        0.0342189              1         0.0121  
   592         594        0.0341884              1         0.0137  
   593         595        0.0341821              1         0.0129  
   594         596        0.0341809              1         0.0123  
   595         597        0.0341792              1         0.0116  
   596         598        0.0341745              1         0.0104  
   597         599        0.0341631              1        0.00826  
   598         600         0.034136              1        0.00477  
   599         601        0.0340817              1        0.00577  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   600         602        0.0340044              1        0.00625  
   601         603        0.0339465              1        0.00468  
   602         604        0.0339296              1        0.00191  
   603         605        0.0339279              1        0.00147  
   604         606        0.0339279              1        0.00146  
   605         607        0.0339278              1        0.00145  
   606         608        0.0339277              1        0.00143  
   607         609        0.0339273              1        0.00139  
   608         610        0.0339264              1        0.00127  
   609         611        0.0339244              1        0.00117  
   610         612        0.0339208              1        0.00156  
   611         613        0.0339168              1        0.00135  
   612         614        0.0339147              1        0.00123  
   613         615        0.0339143              1        0.00125  
   614         616        0.0339142              1         0.0012  
   615         617        0.0339142              1        0.00116  
   616         618        0.0339141              1        0.00108  
   617         619        0.0339139              1       0.000949  
   618         620        0.0339133              1       0.000908  
   619         621        0.0339121              1       0.000908  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   620         622        0.0339098              1       0.000908  
   621         623        0.0339072              1        0.00167  
   622         624        0.0339057              1        0.00205  
   623         625        0.0339053              1        0.00192  
   624         626        0.0339053              1         0.0018  
   625         627        0.0339052              1        0.00171  
   626         628        0.0339051              1        0.00153  
   627         629        0.0339048              1        0.00123  
   628         630         0.033904              1        0.00109  
   629         631        0.0339023              1        0.00111  
   630         632        0.0338994              1        0.00114  
   631         633        0.0338965              1        0.00139  
   632         634        0.0338953              1        0.00117  
   633         635        0.0338951              1        0.00117  
   634         636        0.0338951              1        0.00116  
   635         637         0.033895              1        0.00116  
   636         638         0.033895              1        0.00114  
   637         639        0.0338948              1         0.0011  
   638         640        0.0338943              1       0.000999  
   639         641        0.0338931              1       0.000907  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   640         642        0.0338909              1        0.00151  
   641         643        0.0338877              1        0.00179  
   642         644        0.0338853              1         0.0013  
   643         645        0.0338846              1        0.00113  
   644         646        0.0338846              1        0.00105  
   645         647        0.0338846              1        0.00101  
   646         648        0.0338845              1       0.000947  
   647         649        0.0338844              1       0.000907  
   648         650        0.0338841              1       0.000907  
   649         651        0.0338834              1       0.000907  
   650         652        0.0338816              1         0.0011  
   651         653        0.0338778              1        0.00212  
   652         654        0.0338715              1        0.00333  
   653         655         0.033865              1        0.00394  
   654         656        0.0338621              1        0.00355  
   655         657        0.0338616              1        0.00305  
   656         658        0.0338615              1        0.00286  
   657         659        0.0338612              1         0.0026  
   658         660        0.0338606              1        0.00217  
   659         661        0.0338589              1        0.00181  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   660         662        0.0338549              1        0.00201  
   661         663        0.0338461              1        0.00215  
   662         664        0.0338312              1        0.00356  
   663         665        0.0338161              1        0.00428  
   664         666        0.0338093              1        0.00325  
   665         667        0.0338082              1        0.00272  
   666         668         0.033808              1        0.00259  
   667         669        0.0338077              1        0.00258  
   668         670        0.0338069              1        0.00266  
   669         671         0.033805              1         0.0028  
   670         672        0.0338003              1        0.00291  
   671         673        0.0337896              1        0.00279  
   672         674        0.0337698              1        0.00415  
   673         675        0.0337464              1        0.00432  
   674         676        0.0337331              1        0.00252  
   675         677        0.0337303              1        0.00246  
   676         678          0.03373              1        0.00248  
   677         679        0.0337298              1        0.00247  
   678         680        0.0337291              1        0.00246  
   679         681        0.0337276              1        0.00243  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   680         682        0.0337233              1        0.00238  
   681         683        0.0337127              1        0.00251  
   682         684        0.0336869              1        0.00432  
   683         685        0.0336316              1        0.00642  
   684         686        0.0335413              1        0.00861  
   685         687        0.0334549              1         0.0124  
   686         688        0.0334188              1         0.0129  
   687         689         0.033413              1          0.012  
   688         690        0.0334119              1         0.0115  
   689         691        0.0334098              1         0.0109  
   690         692        0.0334043              1        0.00992  
   691         693        0.0333904              1        0.00815  
   692         694        0.0333556              1        0.00508  
   693         695        0.0332764              1        0.00446  
   694         696        0.0331283              1        0.00664  
   695         697        0.0329458              1         0.0117  
   696         698        0.0328366              1          0.011  
   697         699        0.0328121              1        0.00773  
   698         700        0.0328097              1        0.00695  
   699         701        0.0328086              1        0.00695  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   700         702         0.032805              1        0.00692  
   701         703        0.0327967              1        0.00683  
   702         704        0.0327745              1        0.00654  
   703         705        0.0327213              1        0.00638  
   704         706         0.032603              1        0.00803  
   705         707        0.0323988              1         0.0128  
   706         708        0.0321812              1         0.0125  
   707         709         0.032077              1        0.00883  
   708         710         0.032059              1        0.00908  
   709         711        0.0320573              1        0.00908  
   710         712        0.0320562              1        0.00906  
   711         713        0.0320522              1        0.00902  
   712         714        0.0320431              1        0.00897  
   713         715        0.0320185              1        0.00888  
   714         716        0.0319582              1        0.00875  
   715         717        0.0318177              1        0.00859  
   716         718        0.0315472              1         0.0124  
   717         719        0.0311916              1         0.0153  
   718         720        0.0309563              1         0.0212  
   719         721        0.0308959              1         0.0214  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   720         722        0.0308889              1         0.0204  
   721         723         0.030886              1         0.0199  
   722         724        0.0308763              1         0.0188  
   723         725        0.0308539              1          0.017  
   724         726        0.0307936              1          0.014  
   725         727        0.0306472              1        0.00926  
   726         728        0.0303126              1        0.00903  
   727         729        0.0296964              1         0.0114  
   728         730        0.0289558              1         0.0151  
   729         731        0.0285315              1         0.0137  
   730         732        0.0284417              1          0.015  
   731         733        0.0284342              1         0.0149  
   732         734         0.028432              1         0.0148  
   733         735        0.0284241              1         0.0145  
   734         736        0.0284062              1         0.0141  
   735         737        0.0283574              1         0.0133  
   736         738         0.028237              1         0.0119  
   737         739        0.0279487              1        0.00973  
   738         740        0.0273599              1         0.0152  
   739         741        0.0264876              1         0.0168  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   740         742        0.0257877              1         0.0119  
   741         743        0.0255619              1         0.0135  
   742         744        0.0255378              1          0.013  
   743         745        0.0255365              1         0.0128  
   744         746        0.0255356              1         0.0127  
   745         747        0.0255321              1         0.0122  
   746         748        0.0255243              1         0.0115  
   747         749        0.0255044              1        0.00996  
   748         750        0.0254625              1        0.00709  
   749         751        0.0253926              1        0.00277  
   750         752        0.0253247              1        0.00213  
   751         753        0.0252961              1        0.00208  
   752         754         0.025292              1        0.00155  
   753         755        0.0252918              1        0.00138  
   754         756        0.0252918              1        0.00135  
   755         757        0.0252917              1        0.00134  
   756         758        0.0252914              1        0.00133  
   757         759        0.0252908              1        0.00128  
   758         760        0.0252893              1        0.00126  
   759         761        0.0252861              1        0.00118  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   760         762        0.0252812              1        0.00141  
   761         763        0.0252768              1         0.0021  
   762         764        0.0252751              1        0.00202  
   763         765        0.0252749              1        0.00178  
   764         766        0.0252749              1         0.0017  
   765         767        0.0252749              1        0.00163  
   766         768        0.0252748              1         0.0015  
   767         769        0.0252746              1        0.00128  
   768         770        0.0252741              1       0.000889  
   769         771        0.0252731              1        0.00073  
   770         772        0.0252712              1       0.000544  
   771         773        0.0252694              1       0.000773  
   772         774        0.0252685              1       0.000521  
   773         775        0.0252684              1       0.000309  
   774         776        0.0252684              1       0.000319  
   775         777        0.0252684              1        0.00032  
   776         778        0.0252684              1       0.000322  
   777         779        0.0252684              1       0.000324  
   778         780        0.0252683              1       0.000322  
   779         781        0.0252682              1       0.000311  
                                                        First-order 
 Iteration  Func-count       f(x)        Step-size       optimality
   780         782        0.0252679              1       0.000404  
   781         783        0.0252673              1       0.000635  
   782         784        0.0252664              1       0.000734  
   783         785        0.0252656              1       0.000514  
   784         786        0.0252653              1       0.000356  
   785         787        0.0252652              1       0.000344  
   786         788        0.0252652              1       0.000333  
   787         789        0.0252652              1       0.000327  
   788         790        0.0252652              1       0.000313  
   789         791        0.0252652              1       0.000291  
   790         792        0.0252651              1       0.000253  
   791         793         0.025265              1       0.000216  
   792         794        0.0252648              1       0.000192  
   793         795        0.0252643              1       0.000204  
   794         796        0.0252637              1       0.000255  
   795         797        0.0252633              1       0.000319  
   796         798        0.0252631              1       0.000298  
   797         799        0.0252631              1       0.000275  
   798         800        0.0252631              1        0.00027  
   799         801        0.0252631              1       0.000262  
                       ...
```

![figure_23.png
](README_images/figure_23.png
)

```matlab:Code

% We transform the truncated initial condition of our test trajectory according to 
% the obtained change of coordinates, and integrate our reduced order evolution rule 
% to predict the development of the trajectory. 
[yRec, etaRec, zRec] = advect(IMInfo, RDInfo, yDataTrunc);

% Evaluation of reduced dynamics
% The error NMTE is computed as the average distance of the predicted trajectory 
% to the measured one in the full state space.
normedTrajDist = computeTrajectoryErrors(yRec, yDataTrunc);
NMTE = mean(normedTrajDist(indTest))*100;
disp(['Normalized mean trajectory error = ' num2str(NMTE) '%'])
```

```text:Output
Normalized mean trajectory error = 7.1901%
```

```matlab:Code

% We plot the true test set trajectory in the reduced coordinates and compare it to the prediction. 
plotReducedCoordinates(etaDataTrunc(indTest,:), etaRec(indTest,:))
legend({'Test set (truncated)', 'Prediction'})
if size(Ae,1)==2
    % Plot SSM with trajectories in the normal form reduced coordinates
    plotSSMandTrajectories(IMInfo, outdof, yDataTrunc(indTest,:), ...
        zRec(indTest,:), 'NFT', RDInfo.transformation.map)
    view(-100,20); legend('off')
else
    view(3)
end
```

![figure_24.png
](README_images/figure_24.png
)

We then plot our predictions.

```matlab:Code
fig = customFigure('subPlot',[3 1]); colors = colororder; colSSML = 7; colFOM = 1; cc = 0;
for iTraj = [indTrain(1:end-1)+1]
    cc = cc + 1;
    subplot(3,1,cc)
    plot(etaDataTrunc{iTraj,1},etaDataTrunc{iTraj,2}(1,:),'k','Linewidth',1,'Color',colors(colFOM,:))
    plot(etaRec{iTraj,1},etaRec{iTraj,2}(1,:),':','Linewidth',1.5,'Color',colors(colSSML,:))
    xlabel('$t \, [$s$]$','Interpreter','latex'); 
    ylabel('$u_{1}$ [m]','interpreter','latex'); xlim([0 8])
end
legend('Training trajectory','Prediction')
```

![figure_25.png
](README_images/figure_25.png
)

```matlab:Code
fig = customFigure('subPlot',[3 1]); colors = colororder; colSSML = 7; colFOM = 1; cc = 0;
for iTraj = [indTrain(1:end-1)+1]  
    cc = cc + 1;
    subplot(3,1,cc)
    plot(etaDataTrunc{iTraj,1},etaDataTrunc{iTraj,2}(2,:),'k','Linewidth',1,'Color',colors(colFOM,:))
    plot(etaRec{iTraj,1},etaRec{iTraj,2}(2,:),':','Linewidth',1.5,'Color',colors(colSSML,:))
    xlabel('$t \, [$s$]$','Interpreter','latex'); 
    ylabel('$u_{2}$ [m]','interpreter','latex'); xlim([0 8])
end
legend('Training trajectory','Prediction')
```

![figure_26.png
](README_images/figure_26.png
)

```matlab:Code
fig = customFigure('subPlot',[3 1]); colors = colororder; colSSML = 7; colFOM = 1; cc = 0;
for iTraj = [indTrain(1:end-1)+1]
    cc = cc + 1;
    subplot(3,1,cc)
    plot(yDataTrunc{iTraj,1},yDataTrunc{iTraj,2}(outdof(1),:),'k','Linewidth',1,'Color',colors(colFOM,:))
    plot(yRec{iTraj,1},yRec{iTraj,2}(outdof(1),:),':','Linewidth',1.5,'Color',colors(colSSML,:))
    xlabel('$t \, [$s$]$','Interpreter','latex'); 
    ylabel('$q_{A}$ [m]','interpreter','latex'); xlim([0 8])
end
legend('Training trajectory','Prediction')
```

![figure_27.png
](README_images/figure_27.png
)

```matlab:Code
fig = customFigure('subPlot',[3 1]); colors = colororder; colSSML = 7; colFOM = 1; cc = 0;
for iTraj = [indTrain(1:end-1)+1]  
    cc = cc + 1;
    subplot(3,1,cc)
    plot(yDataTrunc{iTraj,1},yDataTrunc{iTraj,2}(outdof(2),:),'k','Linewidth',1,'Color',colors(colFOM,:))
    plot(yRec{iTraj,1},yRec{iTraj,2}(outdof(2),:),':','Linewidth',1.5,'Color',colors(colSSML,:))
    xlabel('$t \, [$s$]$','Interpreter','latex'); 
    ylabel('$q_{B}$ [m]','interpreter','latex'); xlim([0 8])
end
legend('Training trajectory','Prediction')
```

![figure_28.png
](README_images/figure_28.png
)

# Adding forcing to the ROM

Outer directions: either consider all outer modes or a subset

```matlab:Code
nModes = size(V,2);
outerModes = setdiff(1:nModes,masterModes);
Vo = V(:,outerModes); 
Wo = W(outerModes,:); Lo = full(Wo*A*Vo);
```

Forcing vector

```matlab:Code
forcingVectors = [zeros(n,1); M\loadVector];
```

Construct time periodic SSM model

```matlab:Code
[IMInfoF,RDInfoF] = forcedSSMROM(IMInfo,RDInfo,'nForcingFrequencies',1,...
         'forcingVectors',forcingVectors,'We',We,'Lo',Lo,'Vo',Vo, 'Wo',Wo);
```

# Generate Frequency Responses

```matlab:Code
epsilon = [0.02 0.07];
mFreqs = [1 2];
resonantModes = [1 2 3 4];
omegaSpan = [0.92 1.07]*imag(lambda(1));
% SSMLearn
[FRCSSMLearn] = continuationFRCep(IMInfoF, RDInfoF, epsilon, omegaSpan,@(x) x(outdof,:), mFreqs,resonantModes, 'SSMLearnFRC');
```

```text:Output
 Run='SSMLearnFRC.ep': Continue equilibria along primary branch.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          3.83e-01  2.11e+02    0.0    0.0    0.0
   1   1  1.00e+00  1.16e+00  4.28e-02  2.11e+02    0.0    0.0    0.0
   2   1  1.00e+00  4.82e-02  1.76e-03  2.11e+02    0.1    0.1    0.0
   3   1  1.00e+00  2.10e-03  8.06e-08  2.11e+02    0.1    0.1    0.0
   4   1  1.00e+00  2.07e-07  5.37e-14  2.11e+02    0.1    0.1    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:00   2.1111e+02      1  EP      1.4922e+02   1.8343e-02   2.2716e-02   2.7527e+00   2.8531e+00   2.0000e-02
    1  00:00:01   2.1108e+02      2  HB      1.4920e+02   1.8611e-02   2.2644e-02   2.7246e+00   2.8534e+00   2.0000e-02
   10  00:00:01   2.1072e+02      3          1.4895e+02   2.2752e-02   2.2534e-02   2.5629e+00   2.9487e+00   2.0000e-02
   20  00:00:01   2.0985e+02      4          1.4831e+02   3.5560e-02   2.6254e-02   2.7519e+00   3.6570e+00   2.0000e-02
   27  00:00:01   2.0925e+02      5  SN      1.4782e+02   4.2027e-02   2.5641e-02   3.5620e+00   5.3611e+00   2.0000e-02
   27  00:00:01   2.0925e+02      6  FP      1.4782e+02   4.2026e-02   2.5640e-02   3.5621e+00   5.3613e+00   2.0000e-02
   30  00:00:01   2.0946e+02      7          1.4792e+02   3.2116e-02   1.5783e-02   4.0766e+00   6.3797e+00   2.0000e-02
   31  00:00:01   2.0951e+02      8  FP      1.4793e+02   2.7737e-02   1.1897e-02   4.2192e+00   6.6628e+00   2.0000e-02
   31  00:00:01   2.0951e+02      9  SN      1.4793e+02   2.7707e-02   1.1870e-02   4.2201e+00   6.6646e+00   2.0000e-02
   40  00:00:02   2.0913e+02     10          1.4763e+02   1.5980e-02   3.2760e-03   4.4943e+00   7.2481e+00   2.0000e-02
   50  00:00:02   2.0782e+02     11          1.4669e+02   9.3748e-03   7.3938e-04   4.5942e+00   7.5062e+00   2.0000e-02
   60  00:00:02   2.0606e+02     12          1.4543e+02   6.2255e-03   2.2325e-04   4.6354e+00   7.6234e+00   2.0000e-02
   70  00:00:02   2.0387e+02     13          1.4387e+02   4.4116e-03   8.0581e-05   4.6586e+00   7.6909e+00   2.0000e-02
   80  00:00:02   2.0122e+02     14          1.4200e+02   3.2674e-03   3.3012e-05   4.6731e+00   7.7336e+00   2.0000e-02
   90  00:00:02   1.9763e+02     15          1.3945e+02   2.4154e-03   1.3418e-05   4.6839e+00   7.7655e+00   2.0000e-02
   97  00:00:02   1.9458e+02     16  EP      1.3729e+02   1.9780e-03   7.3905e-06   4.6894e+00   7.7820e+00   2.0000e-02

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:02   2.1111e+02     17  EP      1.4922e+02   1.8343e-02   2.2716e-02   2.7527e+00   2.8531e+00   2.0000e-02
    6  00:00:03   2.1151e+02     18  HB      1.4950e+02   1.8250e-02   2.3812e-02   3.2144e+00   2.9204e+00   2.0000e-02
   10  00:00:03   2.1181e+02     19          1.4970e+02   2.1725e-02   2.4537e-02   3.4275e+00   2.8879e+00   2.0000e-02
   20  00:00:03   2.1218e+02     20          1.4997e+02   2.7325e-02   2.5882e-02   3.4501e+00   2.6563e+00   2.0000e-02
   30  00:00:03   2.1296e+02     21          1.5056e+02   3.6380e-02   2.4707e-02   2.6465e+00   8.2567e-01   2.0000e-02
   31  00:00:03   2.1297e+02     22  SN      1.5057e+02   3.5178e-02   2.3051e-02   2.5376e+00   6.0728e-01   2.0000e-02
   31  00:00:03   2.1297e+02     23  FP      1.5057e+02   3.5176e-02   2.3048e-02   2.5374e+00   6.0688e-01   2.0000e-02
   34  00:00:03   2.1293e+02     24  SN      1.5055e+02   2.7960e-02   1.4853e-02   2.1555e+00  -1.5187e-01   2.0000e-02
   34  00:00:03   2.1293e+02     25  FP      1.5055e+02   2.7913e-02   1.4805e-02   2.1537e+00  -1.5559e-01   2.0000e-02
   40  00:00:03   2.1325e+02     26          1.5078e+02   1.6811e-02   4.5493e-03   1.8185e+00  -8.6492e-01   2.0000e-02
   50  00:00:03   2.1439e+02     27          1.5158e+02   1.0126e-02   1.0607e-03   1.7039e+00  -1.1703e+00   2.0000e-02
   60  00:00:03   2.1609e+02     28          1.5279e+02   6.6264e-03   2.9448e-04   1.6570e+00  -1.3121e+00   2.0000e-02
   70  00:00:04   2.1822e+02     29          1.5429e+02   4.6568e-03   1.0103e-04   1.6317e+00  -1.3894e+00   2.0000e-02
   80  00:00:04   2.2078e+02     30          1.5610e+02   3.4313e-03   4.0083e-05   1.6162e+00  -1.4369e+00   2.0000e-02
   90  00:00:04   2.2418e+02     31          1.5850e+02   2.5437e-03   1.6228e-05   1.6049e+00  -1.4711e+00   2.0000e-02
   94  00:00:04   2.2583e+02     32  EP      1.5967e+02   2.2603e-03   1.1364e-05   1.6014e+00  -1.4820e+00   2.0000e-02
```

![figure_29.png
](README_images/figure_29.png
)

![figure_30.png
](README_images/figure_30.png
)

```text:Output
 Run='SSMLearnFRC.ep.ep': Continue equilibria along primary branch.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          2.90e+00  2.11e+02    0.0    0.0    0.0
   1   1  5.56e-01  1.45e+00  1.55e+00  2.11e+02    0.0    0.0    0.0
   2   1  1.00e+00  3.47e-01  3.69e-01  2.11e+02    0.0    0.0    0.0
   3   1  1.00e+00  4.28e-01  8.54e-03  2.11e+02    0.0    0.0    0.0
   4   1  1.00e+00  2.10e-02  2.43e-04  2.11e+02    0.0    0.0    0.0
   5   1  1.00e+00  2.03e-04  2.39e-09  2.11e+02    0.0    0.0    0.0
   6   1  1.00e+00  5.22e-10  4.23e-16  2.11e+02    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:00   2.1111e+02      1  EP      1.4922e+02   2.8755e-02   5.7950e-02   2.7578e+00   2.7856e+00   7.0000e-02
   10  00:00:00   2.1041e+02      2          1.4875e+02   3.9200e-02   5.1795e-02   2.2443e+00   2.4604e+00   7.0000e-02
   12  00:00:00   2.1033e+02      3  HB      1.4869e+02   4.0585e-02   5.1558e-02   2.2244e+00   2.4552e+00   7.0000e-02
   20  00:00:00   2.0849e+02      4          1.4738e+02   7.1446e-02   5.9413e-02   2.2215e+00   2.7182e+00   7.0000e-02
   30  00:00:00   2.0447e+02      5          1.4449e+02   1.4061e-01   9.6554e-02   2.9535e+00   4.2710e+00   7.0000e-02
   37  00:00:00   2.0416e+02      6  SN      1.4424e+02   1.4483e-01   9.7485e-02   3.2565e+00   4.8802e+00   7.0000e-02
   37  00:00:00   2.0416e+02      7  FP      1.4424e+02   1.4483e-01   9.7485e-02   3.2565e+00   4.8802e+00   7.0000e-02
   40  00:00:00   2.0421e+02      8          1.4427e+02   1.4316e-01   9.5709e-02   3.3651e+00   5.0969e+00   7.0000e-02
   50  00:00:00   2.0587e+02      9          1.4538e+02   1.0654e-01   6.6614e-02   3.9683e+00   6.2877e+00   7.0000e-02
   60  00:00:00   2.0773e+02     10          1.4664e+02   4.8206e-02   1.9331e-02   4.4842e+00   7.2874e+00   7.0000e-02
   61  00:00:00   2.0773e+02     11  FP      1.4664e+02   4.7767e-02   1.8979e-02   4.4874e+00   7.2937e+00   7.0000e-02
   61  00:00:01   2.0773e+02     12  SN      1.4664e+02   4.7767e-02   1.8979e-02   4.4874e+00   7.2937e+00   7.0000e-02
   70  00:00:01   2.0768e+02     13          1.4659e+02   4.1374e-02   1.3996e-02   4.5310e+00   7.3828e+00   7.0000e-02
   80  00:00:01   2.0706e+02     14          1.4615e+02   2.9549e-02   6.1493e-03   4.5985e+00   7.5328e+00   7.0000e-02
   90  00:00:01   2.0532e+02     15          1.4490e+02   1.9521e-02   1.9398e-03   4.6425e+00   7.6463e+00   7.0000e-02
  100  00:00:01   2.0303e+02     16          1.4328e+02   1.3987e-02   7.3207e-04   4.6636e+00   7.7061e+00   7.0000e-02
  110  00:00:01   2.0018e+02     17          1.4126e+02   1.0390e-02   3.0343e-04   4.6768e+00   7.7447e+00   7.0000e-02
  120  00:00:01   1.9617e+02     18          1.3842e+02   7.6526e-03   1.2204e-04   4.6867e+00   7.7741e+00   7.0000e-02
  124  00:00:01   1.9458e+02     19  EP      1.3729e+02   6.9256e-03   9.0609e-05   4.6894e+00   7.7819e+00   7.0000e-02

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:01   2.1111e+02     20  EP      1.4922e+02   2.8755e-02   5.7950e-02   2.7578e+00   2.7856e+00   7.0000e-02
   10  00:00:01   2.1211e+02     21          1.4989e+02   3.8986e-02   5.6405e-02   3.9112e+00   3.6151e+00   7.0000e-02
   12  00:00:01   2.1218e+02     22  HB      1.4994e+02   4.0262e-02   5.6272e-02   3.9341e+00   3.6253e+00   7.0000e-02
   20  00:00:02   2.1308e+02     23          1.5058e+02   5.7456e-02   5.9098e-02   4.0163e+00   3.5550e+00   7.0000e-02
   30  00:00:02   2.1621e+02     24          1.5283e+02   1.2211e-01   9.3709e-02   3.3346e+00   2.0377e+00   7.0000e-02
   36  00:00:02   2.1651e+02     25  SN      1.5306e+02   1.2605e-01   9.3767e-02   2.9570e+00   1.2774e+00   7.0000e-02
   36  00:00:02   2.1651e+02     26  FP      1.5306e+02   1.2605e-01   9.3767e-02   2.9570e+00   1.2774e+00   7.0000e-02
   40  00:00:02   2.1636e+02     27          1.5296e+02   1.1905e-01   8.6392e-02   2.6972e+00   7.6037e-01   7.0000e-02
   50  00:00:02   2.1469e+02     28          1.5179e+02   5.0912e-02   2.4258e-02   1.8440e+00  -9.0324e-01   7.0000e-02
   52  00:00:02   2.1468e+02     29  SN      1.5179e+02   4.8704e-02   2.2252e-02   1.8252e+00  -9.4046e-01   7.0000e-02
   52  00:00:02   2.1468e+02     30  FP      1.5179e+02   4.8704e-02   2.2252e-02   1.8252e+00  -9.4046e-01   7.0000e-02
   60  00:00:02   2.1475e+02     31          1.5184e+02   4.1361e-02   1.5776e-02   1.7671e+00  -1.0588e+00   7.0000e-02
   70  00:00:02   2.1537e+02     32          1.5228e+02   2.9615e-02   6.8929e-03   1.6917e+00  -1.2274e+00   7.0000e-02
   80  00:00:02   2.1714e+02     33          1.5352e+02   1.9557e-02   2.1096e-03   1.6452e+00  -1.3513e+00   7.0000e-02
   90  00:00:02   2.1942e+02     34          1.5514e+02   1.4021e-02   7.8062e-04   1.6238e+00  -1.4143e+00   7.0000e-02
  100  00:00:03   2.2228e+02     35          1.5716e+02   1.0420e-02   3.1922e-04   1.6105e+00  -1.4543e+00   7.0000e-02
  110  00:00:03   2.2583e+02     36  EP      1.5967e+02   7.9143e-03   1.3931e-04   1.6014e+00  -1.4819e+00   7.0000e-02
```

![figure_31.png
](README_images/figure_31.png
)

![figure_32.png
](README_images/figure_32.png
)

```matlab:Code
% SSMTool
[FRCSSMTool1] = SSMToolFRCFE(M,C,K,fnl,f_0,outdof,epsilon(1),resonantModes,4,omegaSpan,mFreqs,'SSMToolFRC');
```

```text:Output
Due to high-dimensionality, we compute only the first 5 eigenvalues with the smallest magnitude. These would also be used to compute the spectral quotients
Assuming a proportional damping hypthesis with symmetric matrices
modal damping ratio for 1 mode is 2.000000e-03
modal damping ratio for 2 mode is 2.000000e-03
modal damping ratio for 3 mode is 2.102524e-03
modal damping ratio for 4 mode is 2.141338e-03
modal damping ratio for 5 mode is 2.369557e-03
the left eigenvectors may be incorrect in case of asymmetry of matrices

 The first 10 nonzero eigenvalues are given as 
   1.0e+02 *

  -0.0030 + 1.4922i
  -0.0030 - 1.4922i
  -0.0060 + 2.9878i
  -0.0060 - 2.9878i
  -0.0071 + 3.3973i
  -0.0071 - 3.3973i
  -0.0076 + 3.5356i
  -0.0076 - 3.5356i
  -0.0101 + 4.2617i
  -0.0101 - 4.2617i

(near) outer resonance detected for the following combination of master eigenvalues
     2     0     0     0
     0     0     2     1
     1     1     1     0
     0     2     0     0
     0     0     1     2
     1     1     0     1
     2     0     0     0
     0     0     2     1
     1     1     1     0
     0     2     0     0
     0     0     1     2
     1     1     0     1
     1     0     1     0
     0     1     2     0
     3     0     0     0
     0     1     0     1
     0     3     0     0
     1     0     0     2

These are in resonance with the follwing eigenvalues of the slave subspace
   1.0e+02 *

  -0.0071 + 3.3973i
  -0.0071 + 3.3973i
  -0.0071 + 3.3973i
  -0.0071 - 3.3973i
  -0.0071 - 3.3973i
  -0.0071 - 3.3973i
  -0.0076 + 3.5356i
  -0.0076 + 3.5356i
  -0.0076 + 3.5356i
  -0.0076 - 3.5356i
  -0.0076 - 3.5356i
  -0.0076 - 3.5356i
  -0.0101 + 4.2617i
  -0.0101 + 4.2617i
  -0.0101 + 4.2617i
  -0.0101 - 4.2617i
  -0.0101 - 4.2617i
  -0.0101 - 4.2617i

sigma_out = 3
(near) inner resonance detected for the following combination of master eigenvalues
     0     1     1     0
     1     0     1     1
     2     1     0     0
     1     0     0     1
     0     1     1     1
     1     2     0     0
     2     0     0     0
     0     0     2     1
     1     1     1     0
     0     2     0     0
     0     0     1     2
     1     1     0     1

These are in resonance with the follwing eigenvalues of the master subspace
   1.0e+02 *

  -0.0030 + 1.4922i
  -0.0030 + 1.4922i
  -0.0030 + 1.4922i
  -0.0030 - 1.4922i
  -0.0030 - 1.4922i
  -0.0030 - 1.4922i
  -0.0060 + 2.9878i
  -0.0060 + 2.9878i
  -0.0060 + 2.9878i
  -0.0060 - 2.9878i
  -0.0060 - 2.9878i
  -0.0060 - 2.9878i

sigma_in = 3
Due to (near) outer resonance, the exisitence of the manifold is questionable and the underlying computation may suffer.
Attempting manifold computation
Manifold computation time at order 2 = 00:00:01
Estimated memory usage at order  2 = 1.61E+01 MB
Manifold computation time at order 3 = 00:00:03
Estimated memory usage at order  3 = 2.10E+01 MB
Manifold computation time at order 4 = 00:00:07
Estimated memory usage at order  4 = 3.26E+01 MB

 Run='SSMToolFRC.ep': Continue equilibria along primary branch.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          5.49e-01  2.11e+02    0.0    0.0    0.0
   1   1  1.00e+00  4.60e-01  7.51e-02  2.11e+02    0.0    0.0    0.0
   2   1  1.00e+00  8.03e-02  1.21e-02  2.11e+02    0.0    0.0    0.0
   3   1  1.00e+00  1.63e-02  1.08e-04  2.11e+02    0.0    0.0    0.0
   4   1  1.00e+00  3.78e-04  1.70e-08  2.11e+02    0.0    0.0    0.0
   5   1  1.00e+00  1.94e-08  2.38e-16  2.11e+02    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:00   2.1113e+02      1  EP      1.4922e+02   3.3933e-03   2.3719e-03   1.1624e+00   4.4064e+00   2.0000e-02
    1  00:00:00   2.1110e+02      2  HB      1.4920e+02   3.4421e-03   2.3640e-03   1.1359e+00   4.4068e+00   2.0000e-02
   10  00:00:00   2.1074e+02      3          1.4895e+02   4.2261e-03   2.3469e-03   9.7590e-01   4.5042e+00   2.0000e-02
   20  00:00:00   2.0984e+02      4          1.4828e+02   6.7184e-03   2.7463e-03   1.1819e+00   5.2470e+00   2.0000e-02
   27  00:00:00   2.0928e+02      5  SN      1.4781e+02   7.8773e-03   2.6854e-03   1.9696e+00   6.8988e+00   2.0000e-02
   27  00:00:00   2.0928e+02      6  FP      1.4781e+02   7.8772e-03   2.6854e-03   1.9696e+00   6.8989e+00   2.0000e-02
   30  00:00:00   2.0951e+02      7          1.4791e+02   5.9507e-03   1.6383e-03   2.5024e+00   7.9505e+00   2.0000e-02
   31  00:00:00   2.0956e+02      8  FP      1.4793e+02   5.1002e-03   1.2215e-03   2.6499e+00   8.2419e+00   2.0000e-02
   31  00:00:00   2.0956e+02      9  SN      1.4793e+02   5.0957e-03   1.2194e-03   2.6506e+00   8.2434e+00   2.0000e-02
   40  00:00:00   2.0920e+02     10          1.4764e+02   2.9728e-03   3.4923e-04   2.9186e+00   8.8107e+00   2.0000e-02
   50  00:00:00   2.0791e+02     11          1.4670e+02   1.7392e-03   7.8631e-05   3.0206e+00   9.0722e+00   2.0000e-02
   60  00:00:01   2.0614e+02     12          1.4544e+02   1.1523e-03   2.3607e-05   3.0623e+00   9.1907e+00   2.0000e-02
   70  00:00:01   2.0396e+02     13          1.4389e+02   8.1610e-04   8.5094e-06   3.0856e+00   9.2585e+00   2.0000e-02
   80  00:00:01   2.0132e+02     14          1.4202e+02   6.0429e-04   3.4840e-06   3.1002e+00   9.3014e+00   2.0000e-02
   90  00:00:01   1.9774e+02     15          1.3948e+02   4.4672e-04   1.4161e-06   3.1110e+00   9.3334e+00   2.0000e-02
   97  00:00:01   1.9465e+02     16  EP      1.3729e+02   3.6478e-04   7.7348e-07   3.1166e+00   9.3501e+00   2.0000e-02

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:01   2.1113e+02     17  EP      1.4922e+02   3.3933e-03   2.3719e-03   1.1624e+00   4.4064e+00   2.0000e-02
    5  00:00:01   2.1153e+02     18  HB      1.4950e+02   3.3527e-03   2.4974e-03   1.6228e+00   4.4714e+00   2.0000e-02
   10  00:00:01   2.1180e+02     19          1.4969e+02   3.9243e-03   2.5742e-03   1.8299e+00   4.4456e+00   2.0000e-02
   20  00:00:01   2.1213e+02     20          1.4993e+02   4.8543e-03   2.7052e-03   1.8702e+00   4.2468e+00   2.0000e-02
   30  00:00:01   2.1292e+02     21          1.5053e+02   6.7610e-03   2.7518e-03   1.1888e+00   2.6337e+00   2.0000e-02
   32  00:00:01   2.1294e+02     22  SN      1.5055e+02   6.3508e-03   2.3818e-03   9.3791e-01   2.1273e+00   2.0000e-02
   32  00:00:02   2.1294e+02     23  FP      1.5055e+02   6.3505e-03   2.3815e-03   9.3776e-01   2.1270e+00   2.0000e-02
   34  00:00:02   2.1291e+02     24  FP      1.5054e+02   5.1970e-03   1.6084e-03   5.9856e-01   1.4514e+00   2.0000e-02
   34  00:00:02   2.1291e+02     25  SN      1.5054e+02   5.1911e-03   1.6048e-03   5.9722e-01   1.4487e+00   2.0000e-02
   40  00:00:02   2.1320e+02     26          1.5075e+02   3.1706e-03   5.0883e-04   2.5427e-01   7.2470e-01   2.0000e-02
   50  00:00:02   2.1427e+02     27          1.5151e+02   1.9232e-03   1.2144e-04   1.3548e-01   4.1072e-01   2.0000e-02
   60  00:00:02   2.1595e+02     28          1.5270e+02   1.2519e-03   3.3180e-05   8.6284e-02   2.6254e-01   2.0000e-02
   70  00:00:02   2.1805e+02     29          1.5419e+02   8.7671e-04   1.1257e-05   6.0176e-02   1.8256e-01   2.0000e-02
   80  00:00:02   2.2059e+02     30          1.5598e+02   6.4446e-04   4.4331e-06   4.4187e-02   1.3370e-01   2.0000e-02
   90  00:00:02   2.2391e+02     31          1.5833e+02   4.7812e-04   1.7989e-06   3.2770e-02   9.8950e-02   2.0000e-02
   95  00:00:02   2.2581e+02     32  EP      1.5967e+02   4.1685e-04   1.1893e-06   2.8567e-02   8.6194e-02   2.0000e-02
```

![figure_33.png
](README_images/figure_33.png
)

![figure_34.png
](README_images/figure_34.png
)

```text:Output
the forcing frequency 1.3729e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3748e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3783e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3819e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3853e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3885e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3917e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3948e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3977e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4006e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4033e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4060e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4086e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4111e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4135e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4158e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4180e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4202e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4223e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4243e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4263e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4282e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4301e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4319e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4337e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4354e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4372e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4389e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4406e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4422e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4439e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4455e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4471e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4486e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4501e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4516e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4531e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4544e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4559e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4572e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4586e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4598e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4612e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4623e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4636e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4647e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4659e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4670e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4681e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4691e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4702e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4712e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4721e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4732e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4743e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4752e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4758e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4764e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4768e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4772e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4776e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4779e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4781e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4784e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4786e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4790e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4793e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4793e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4793e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4791e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4787e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4783e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4781e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4781e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4781e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4781e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4783e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4788e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4795e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4804e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4816e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4828e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4840e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4851e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4860e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4868e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4874e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4880e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4884e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4888e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4892e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4895e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4898e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4900e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4903e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4905e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4907e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4910e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4912e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4915e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4918e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4920e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4922e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4922e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4926e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4930e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4934e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4941e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4950e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4956e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4960e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4963e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4965e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4967e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4969e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4971e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4973e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4975e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4977e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4979e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4981e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4984e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4986e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4990e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4993e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4997e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5002e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5007e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5013e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5020e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5028e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5036e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5043e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5049e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5053e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5055e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5055e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5055e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5055e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5055e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5054e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5054e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5054e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5058e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5062e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5066e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5069e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5072e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5075e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5079e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5083e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5088e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5094e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5101e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5109e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5121e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5132e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5142e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5151e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5162e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5173e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5184e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5195e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5207e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5219e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5232e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5244e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5257e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5270e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5284e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5297e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5312e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5326e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5341e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5356e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5372e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5387e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5403e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5419e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5436e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5452e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5470e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5486e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5505e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5522e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5541e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5559e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5578e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5598e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5618e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5639e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5660e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5682e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5705e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5729e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5754e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5779e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5806e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5833e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5861e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5891e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5921e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5952e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5967e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
```

![figure_35.png
](README_images/figure_35.png
)

![figure_36.png
](README_images/figure_36.png
)

```matlab:Code
[FRCSSMTool2] = SSMToolFRCFE(M,C,K,fnl,f_0,outdof,epsilon(2),resonantModes,4,omegaSpan,mFreqs,'SSMToolFRC');
```

```text:Output
Due to high-dimensionality, we compute only the first 5 eigenvalues with the smallest magnitude. These would also be used to compute the spectral quotients
Assuming a proportional damping hypthesis with symmetric matrices
modal damping ratio for 1 mode is 2.000000e-03
modal damping ratio for 2 mode is 2.000000e-03
modal damping ratio for 3 mode is 2.102524e-03
modal damping ratio for 4 mode is 2.141338e-03
modal damping ratio for 5 mode is 2.369557e-03
the left eigenvectors may be incorrect in case of asymmetry of matrices

 The first 10 nonzero eigenvalues are given as 
   1.0e+02 *

  -0.0030 + 1.4922i
  -0.0030 - 1.4922i
  -0.0060 + 2.9878i
  -0.0060 - 2.9878i
  -0.0071 + 3.3973i
  -0.0071 - 3.3973i
  -0.0076 + 3.5356i
  -0.0076 - 3.5356i
  -0.0101 + 4.2617i
  -0.0101 - 4.2617i

(near) outer resonance detected for the following combination of master eigenvalues
     2     0     0     0
     0     0     2     1
     1     1     1     0
     0     2     0     0
     0     0     1     2
     1     1     0     1
     2     0     0     0
     0     0     2     1
     1     1     1     0
     0     2     0     0
     0     0     1     2
     1     1     0     1
     1     0     1     0
     0     1     2     0
     3     0     0     0
     0     1     0     1
     0     3     0     0
     1     0     0     2

These are in resonance with the follwing eigenvalues of the slave subspace
   1.0e+02 *

  -0.0071 + 3.3973i
  -0.0071 + 3.3973i
  -0.0071 + 3.3973i
  -0.0071 - 3.3973i
  -0.0071 - 3.3973i
  -0.0071 - 3.3973i
  -0.0076 + 3.5356i
  -0.0076 + 3.5356i
  -0.0076 + 3.5356i
  -0.0076 - 3.5356i
  -0.0076 - 3.5356i
  -0.0076 - 3.5356i
  -0.0101 + 4.2617i
  -0.0101 + 4.2617i
  -0.0101 + 4.2617i
  -0.0101 - 4.2617i
  -0.0101 - 4.2617i
  -0.0101 - 4.2617i

sigma_out = 3
(near) inner resonance detected for the following combination of master eigenvalues
     0     1     1     0
     1     0     1     1
     2     1     0     0
     1     0     0     1
     0     1     1     1
     1     2     0     0
     2     0     0     0
     0     0     2     1
     1     1     1     0
     0     2     0     0
     0     0     1     2
     1     1     0     1

These are in resonance with the follwing eigenvalues of the master subspace
   1.0e+02 *

  -0.0030 + 1.4922i
  -0.0030 + 1.4922i
  -0.0030 + 1.4922i
  -0.0030 - 1.4922i
  -0.0030 - 1.4922i
  -0.0030 - 1.4922i
  -0.0060 + 2.9878i
  -0.0060 + 2.9878i
  -0.0060 + 2.9878i
  -0.0060 - 2.9878i
  -0.0060 - 2.9878i
  -0.0060 - 2.9878i

sigma_in = 3
Due to (near) outer resonance, the exisitence of the manifold is questionable and the underlying computation may suffer.
Attempting manifold computation
Manifold computation time at order 2 = 00:00:01
Estimated memory usage at order  2 = 1.61E+01 MB
Manifold computation time at order 3 = 00:00:03
Estimated memory usage at order  3 = 2.10E+01 MB
Manifold computation time at order 4 = 00:00:08
Estimated memory usage at order  4 = 3.26E+01 MB

 Run='SSMToolFRC.ep': Continue equilibria along primary branch.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          3.82e+00  2.11e+02    0.0    0.0    0.0
   1   1  1.00e+00  7.34e-01  1.29e+00  2.11e+02    0.0    0.0    0.0
   2   1  1.00e+00  1.02e+00  7.34e-01  2.11e+02    0.0    0.0    0.0
   3   1  5.40e-01  2.17e+00  3.94e-01  2.11e+02    0.0    0.0    0.0
   4   1  1.00e+00  6.52e-01  4.40e-02  2.11e+02    0.0    0.0    0.0
   5   1  1.00e+00  1.43e-01  2.44e-03  2.11e+02    0.0    0.0    0.0
   6   1  1.00e+00  1.21e-03  1.30e-06  2.11e+02    0.0    0.0    0.0
   7   1  1.00e+00  3.00e-06  1.15e-12  2.11e+02    0.0    0.0    0.0
   8   1  1.00e+00  4.70e-13  8.54e-17  2.11e+02    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:00   2.1113e+02      1  EP      1.4922e+02   5.3502e-03   6.0161e-03   1.1237e+00   4.2968e+00   7.0000e-02
   10  00:00:00   2.1045e+02      2          1.4875e+02   7.2896e-03   5.3427e-03   6.4656e-01   3.9989e+00   7.0000e-02
   12  00:00:00   2.1036e+02      3  HB      1.4869e+02   7.5694e-03   5.3122e-03   6.2580e-01   3.9938e+00   7.0000e-02
   20  00:00:00   2.0836e+02      4          1.4727e+02   1.3802e-02   6.1589e-03   6.3466e-01   4.2799e+00   7.0000e-02
   30  00:00:00   2.0410e+02      5          1.4420e+02   2.7433e-02   9.8985e-03   1.3263e+00   5.7521e+00   7.0000e-02
   38  00:00:00   2.0367e+02      6  SN      1.4386e+02   2.8611e-02   1.0092e-02   1.6541e+00   6.4119e+00   7.0000e-02
   38  00:00:00   2.0367e+02      7  FP      1.4386e+02   2.8611e-02   1.0092e-02   1.6541e+00   6.4119e+00   7.0000e-02
   40  00:00:00   2.0369e+02      8          1.4387e+02   2.8455e-02   1.0007e-02   1.7187e+00   6.5408e+00   7.0000e-02
   50  00:00:00   2.0479e+02      9          1.4460e+02   2.4097e-02   8.3022e-03   2.1732e+00   7.4385e+00   7.0000e-02
   60  00:00:01   2.0776e+02     10          1.4662e+02   9.0585e-03   2.0526e-03   2.9044e+00   8.8465e+00   7.0000e-02
   62  00:00:01   2.0777e+02     11  FP      1.4662e+02   8.7863e-03   1.9331e-03   2.9149e+00   8.8672e+00   7.0000e-02
   62  00:00:01   2.0777e+02     12  SN      1.4662e+02   8.7863e-03   1.9331e-03   2.9149e+00   8.8672e+00   7.0000e-02
   70  00:00:01   2.0773e+02     13          1.4658e+02   7.7410e-03   1.4856e-03   2.9534e+00   8.9447e+00   7.0000e-02
   80  00:00:01   2.0727e+02     14          1.4625e+02   5.7767e-03   7.4189e-04   3.0160e+00   9.0800e+00   7.0000e-02
   90  00:00:01   2.0554e+02     15          1.4502e+02   3.7106e-03   2.2076e-04   3.0671e+00   9.2079e+00   7.0000e-02
  100  00:00:01   2.0330e+02     16          1.4342e+02   2.6441e-03   8.2301e-05   3.0894e+00   9.2705e+00   7.0000e-02
  110  00:00:01   2.0052e+02     17          1.4145e+02   1.9642e-03   3.4157e-05   3.1030e+00   9.3101e+00   7.0000e-02
  120  00:00:01   1.9663e+02     18          1.3869e+02   1.4479e-03   1.3782e-05   3.1132e+00   9.3401e+00   7.0000e-02
  125  00:00:01   1.9465e+02     19  EP      1.3729e+02   1.2773e-03   9.4836e-06   3.1166e+00   9.3501e+00   7.0000e-02

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:01   2.1113e+02     20  EP      1.4922e+02   5.3502e-03   6.0161e-03   1.1237e+00   4.2968e+00   7.0000e-02
   10  00:00:02   2.1215e+02     21          1.4991e+02   7.1561e-03   6.0057e-03   2.3200e+00   5.1556e+00   7.0000e-02
   11  00:00:02   2.1220e+02     22  HB      1.4994e+02   7.3280e-03   5.9990e-03   2.3374e+00   5.1634e+00   7.0000e-02
   20  00:00:02   2.1309e+02     23          1.5057e+02   1.0418e-02   6.3430e-03   2.4254e+00   5.0963e+00   7.0000e-02
   30  00:00:02   2.1601e+02     24          1.5269e+02   2.1375e-02   1.0049e-02   1.7629e+00   3.6130e+00   7.0000e-02
   36  00:00:02   2.1630e+02     25  SN      1.5291e+02   2.2072e-02   1.0037e-02   1.3740e+00   2.8295e+00   7.0000e-02
   36  00:00:02   2.1630e+02     26  FP      1.5291e+02   2.2072e-02   1.0037e-02   1.3740e+00   2.8295e+00   7.0000e-02
   40  00:00:02   2.1612e+02     27          1.5280e+02   2.0652e-02   9.0545e-03   1.0827e+00   2.2501e+00   7.0000e-02
   50  00:00:02   2.1463e+02     28  SN      1.5177e+02   9.0011e-03   2.4033e-03   2.5747e-01   6.3957e-01   7.0000e-02
   50  00:00:02   2.1463e+02     29  FP      1.5177e+02   9.0010e-03   2.4033e-03   2.5747e-01   6.3956e-01   7.0000e-02
   50  00:00:02   2.1464e+02     30          1.5177e+02   8.7598e-03   2.2739e-03   2.4617e-01   6.1693e-01   7.0000e-02
   60  00:00:02   2.1476e+02     31          1.5186e+02   7.2124e-03   1.4808e-03   1.7968e-01   4.7951e-01   7.0000e-02
   70  00:00:03   2.1575e+02     32          1.5256e+02   4.8206e-03   5.1516e-04   1.0160e-01   2.9716e-01   7.0000e-02
   80  00:00:03   2.1768e+02     33          1.5392e+02   3.2793e-03   1.6686e-04   6.5428e-02   1.9670e-01   7.0000e-02
   90  00:00:03   2.2009e+02     34          1.5563e+02   2.3854e-03   6.4151e-05   4.6988e-02   1.4184e-01   7.0000e-02
  100  00:00:03   2.2320e+02     35          1.5783e+02   1.7729e-03   2.6213e-05   3.4787e-02   1.0499e-01   7.0000e-02
  107  00:00:03   2.2581e+02     36  EP      1.5967e+02   1.4594e-03   1.4579e-05   2.8607e-02   8.6276e-02   7.0000e-02
```

![figure_37.png
](README_images/figure_37.png
)

![figure_38.png
](README_images/figure_38.png
)

```text:Output
the forcing frequency 1.3729e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3731e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3766e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3801e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3836e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3869e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3901e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3932e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3962e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.3991e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4019e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4046e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4072e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4097e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4121e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4145e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4167e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4189e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4210e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4231e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4250e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4269e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4289e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4306e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4325e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4342e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4360e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4377e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4394e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4410e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4427e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4442e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4458e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4472e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4488e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4502e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4516e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4529e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4543e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4555e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4568e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4580e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4592e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4602e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4613e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4625e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4634e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4641e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4645e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4649e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4651e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4653e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4655e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4656e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4658e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4658e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4659e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4660e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4660e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4661e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4661e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4661e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4662e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4662e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4662e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4662e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4662e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4662e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4661e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4657e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4646e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4633e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4605e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4575e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4546e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4517e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4488e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4460e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4441e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4427e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4416e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4408e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4402e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4397e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4394e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4391e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4389e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4387e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4386e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4386e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4386e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4386e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4386e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4387e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4388e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4391e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4394e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4399e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4407e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4420e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4443e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4471e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4501e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4532e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4563e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4595e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4627e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4660e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4693e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4727e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4760e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4792e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4813e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4829e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4841e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4850e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4858e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4865e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4869e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4870e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4875e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4880e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4884e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4889e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4893e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4897e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4901e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4907e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4914e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4920e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4922e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4922e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4925e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4929e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4937e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4947e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4960e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4971e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4978e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4983e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4987e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4991e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4994e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4995e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.4999e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5004e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5009e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5014e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5020e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5027e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5036e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5045e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5057e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5072e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5091e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5113e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5140e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5170e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5198e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5223e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5242e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5257e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5269e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5277e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5283e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5287e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5290e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5291e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5291e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5291e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5291e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5290e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5288e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5285e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5280e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5273e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5264e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5252e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5236e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5215e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5195e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5186e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5178e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5177e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5177e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5177e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5177e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5177e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5178e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5178e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5179e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5180e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5180e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5182e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5183e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5184e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5186e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5188e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5191e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5194e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5198e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5204e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5212e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5222e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5234e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5245e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5256e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5268e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5280e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5293e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5306e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5320e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5333e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5348e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5362e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5377e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5392e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5408e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5424e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5440e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5456e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5474e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5491e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5509e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5526e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5545e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5563e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5582e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5601e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5621e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5642e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5663e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5686e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5709e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5732e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5757e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5783e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5809e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5836e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5865e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5894e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5924e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5956e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
the forcing frequency 1.5967e+02 is nearly resonant with the eigenvalue -2.9845e-01 + i1.4922e+02
```

![figure_39.png
](README_images/figure_39.png
)

![figure_40.png
](README_images/figure_40.png
)

```matlab:Code
FRCSSMTool = struct('F1',FRCSSMTool1.F1,'F2',FRCSSMTool2.F1);
```

# **Plot results**

```matlab:Code
fig = customFigure('subPlot',[2 1]);
subplot(211)
plotFRC(FRCSSMLearn, colors(colSSML,:), '- SSMLearn','freqscale',2*pi)
plotFRC(FRCSSMTool, colors(colSSMT,:), '- Tool','freqscale',2*pi)
xlabel('$\Omega$ [Hz]','interpreter','latex')
ylabel('amp($q_{A}$) [m]','interpreter','latex')
legend('off')
xlim([22.5 25])
subplot(212)
plotFRC(FRCSSMLearn, colors(colSSML,:), '- SSMLearn','outamp',2,'freqscale',2*pi)
plotFRC(FRCSSMTool, colors(colSSMT,:), '- SSMTool','outamp',2,'freqscale',2*pi)
xlabel('$\Omega$ [Hz]','interpreter','latex')
ylabel('amp($q_{B}$) [m]','interpreter','latex')
xlim([22.5 25])
ylim([0 11e-4])
legend('NumColumns',2)

% Linear Response
LinResp = @(w) (-M*w^2+1i*w*C+K)\(M*forcingVectors(n+1:end));
omegaVec = linspace(omegaSpan(1),omegaSpan(2),1001);
ampVec = zeros(2,length(omegaVec));
for iW = 1:length(omegaVec)
    X0 = abs(LinResp(omegaVec(iW)));
    ampVec(:,iW) = X0(outdof);
end
for iEps = 1:length(epsilon)
    if iEps == 1; visib = 'on'; else; visib = 'off'; end 
    subplot(211)
    plot(omegaVec/2/pi,ampVec(1,:)*epsilon(iEps),'k:','DisplayName', 'FRC - Linear', 'Linewidth', 1.5,'HandleVisibility',visib)
    subplot(212)
    plot(omegaVec/2/pi,ampVec(2,:)*epsilon(iEps),'k:','DisplayName', 'FRC - Linear', 'Linewidth', 1.5,'HandleVisibility',visib)
end
```

![figure_41.png
](README_images/figure_41.png
)
